

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with SOEP Data &mdash; DTC 1.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with SOEP Documentation" href="../Working with SOEP Documentation/index.html" />
    <link rel="prev" title="Principles of Data Structure" href="../Principles of Data Structure/index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> DTC
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Contents of SOEPcore/index.html">Contents of SOEPcore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Target Population and Samples/index.html">Target Population and Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Survey Design/index.html">Survey Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Principles of Data Structure/index.html">Principles of Data Structure</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Working with SOEP Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#working-with-tracking-data-ppfad">Working with Tracking Data (PPFAD)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-a-cross-section-data-set">Generating a cross-section Data Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-migration-data-bioimmig">Working with Migration Data (BIOIMMIG)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-a-longitudinal-data-set">Generating a longitudinal Data Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#longitudinal-data-analysis">Longitudinal Data Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fixed-effects-estimation">Fixed Effects Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#working-with-soep-regional-data">Working with SOEP Regional Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Working with SOEP Documentation/index.html">Working with SOEP Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DTC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Working with SOEP Data</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Working with SOEP Data/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-soep-data">
<h1>Working with SOEP Data<a class="headerlink" href="#working-with-soep-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="working-with-tracking-data-ppfad">
<span id="working-ppfad"></span><h2>Working with Tracking Data (PPFAD)<a class="headerlink" href="#working-with-tracking-data-ppfad" title="Permalink to this headline">¶</a></h2>
<p>For all years since 1984, the PPFAD data set contains information on all persons who have ever lived in a SOEP household at a survey time (i.e. all respondents, but also children under 17 years of age and persons who have never given an interview). PPFAD is important for the distinction of the research units (persons), especially for longitudinal analyses. In addition, paneldata.org uses PPFAD to differentiate the study population.</p>
<p><strong>Time constant information of persons:</strong></p>
<ul class="simple">
<li>Never changing Person ID (adults, adolescents, children)</li>
<li>Original Household Number</li>
<li>Gender, year of birth, month of birth, year of death if applicable</li>
<li>Migrant Background</li>
<li>Sample Membership (psample)</li>
</ul>
<p><strong>Time-varying information from people:</strong></p>
<ul class="simple">
<li>Current Household Number: If you move to another household, the household number changes (hhnrakt or $hhnr)</li>
<li>Survey Status ($netto, $netold)</li>
<li>Population Membership (private household, institutional households)</li>
<li>Survey Region (East or West Germany)</li>
</ul>
<p>The data set is explained in more detail in a documentation:</p>
<p><a class="reference external" href="http://www.diw.de/documents/publikationen/73/diw_01.c.581313.de/diw_ssp0487.pdf">Dokumentation PPFAD</a>:</p>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store your script, log files, datasets and temporary datasets. Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***********************************************</span>
<span class="o">*</span> <span class="n">Set</span> <span class="n">relative</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span>
<span class="o">***********************************************</span>
<span class="k">global</span> <span class="n">AVZ</span> 	<span class="s2">&quot;H:\material\exercises&quot;</span>
<span class="k">global</span> <span class="n">MY_IN_PATH</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\complete\soep-core\soep.v33.2\stata_en</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_DO_FILES</span> <span class="s2">&quot;$AVZ\do</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_LOG_OUT</span> <span class="s2">&quot;$AVZ\log</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_DATA</span> <span class="s2">&quot;$AVZ\output</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_TEMP</span> <span class="s2">&quot;$AVZ</span><span class="se">\t</span><span class="s2">emp</span><span class="se">\&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p><strong>Based on the data in PPFAD, answer the following questions:</strong></p>
<p><strong>1. Look at the two people with the person ID (variable persnr) 2102 and 19202</strong></p>
<p><strong>a) What gender are they? When were they born and possibly died?</strong></p>
<p>Open the PPFAD dataset. Search the data set for variables that describe gender, year of birth and year of death. Display the information of the variables for persons 2102 and 19202.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>use &quot;${MY_IN_PATH}ppfad.dta&quot;, clear

* a) What gender are they? When were they born and eventually died?
list persnr sex gebjahr todjahr if persnr == 2102 | persnr == 19202
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_1.a.PNG" src="../_images/aufgabe_1.a.PNG" />
</div>
<p><strong>b) Were these people and their parents born in Germany?</strong></p>
<p>In the data set, search for a variable that describes the migration background.
Display the information of the variable for persons 2102 and 19202.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* b) Were these people and their parents born in Germany?
list persnr migback if persnr == 2102 | persnr == 19202
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_1.b.PNG" src="../_images/aufgabe_1.b.PNG" />
</div>
<p><strong>c) If they have immigrated: In which year and from which country?</strong></p>
<p>Search the data set for a variable that describes the country of birth and the year of moving to Germany. Display the information of the variables for persons 2102 and 19202.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*c) If they have immigrated: In which year and from which country?
list persnr immiyear corigin if persnr  == 2102 | persnr == 19202
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_1.c.PNG" src="../_images/aufgabe_1.c.PNG" />
</div>
<p><strong>d) Are these people from East or West Germany?</strong></p>
<p>Search the data set for a variable that describes east-west affiliation.
Display the information of the variables for persons 2102 and 19202.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*d) Are these people from East or West Germany?
list persnr loc1989 psample if persnr  == 2102 | persnr == 19202
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_1.d.PNG" src="../_images/aufgabe_1.d.PNG" />
</div>
<p><strong>e) From which sources does the information on the migration background and the year of death come?</strong></p>
<p>Search the data set for info variables that show you sources of information for the year of death and the migration background. Display the information of the variables for persons 2102 and 19202.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*e) From which sources does the information on the migration background and the year of death come?
list miginfo todinfo if persnr  == 2102 | persnr == 19202
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_1.e.PNG" src="../_images/aufgabe_1.e.PNG" />
</div>
<p><strong>2. How many people lived in a realised private household in 2016 and answered the individual questionnaire?</strong></p>
<p>Remember that the wave-specific survey year in SOEP is abbreviated with letters. SOEP started in 1984 (wave a) and was in a survey wave “bg” in 2016. For more information on this topic, please refer to the DTC subchapter <a class="reference internal" href="../Principles of Data Structure/index.html#label"><span class="std std-ref">Labeling SOEP-Core</span></a>.</p>
<p>If you are interested in the 2016 survey year, the wave name indicates that you should be interested in variables with the abbreviation “bg”.
Search the data set for variables with the abbreviation “bg” that describe the population. Display the characteristics of the population variables:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span>********************************************************************************
*** Exercise 2) ***
* How many people lived in a realised private household in 2016 and answered the 
* personal questionnaire?

********************************************************************************

* informationen from:
* 2016 -&gt; Wave bg
* private household -&gt; bgpop
* Individual questionnaire -&gt; bgnetto

tab bgpop
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_2_1.PNG" src="../_images/aufgabe_2_1.PNG" />
</div>
<p>Values 1 and 2 are relevant to answer the question because they describe realized households. Search the data set for variables with the abbreviation “bg” that describe the survey status. Display the characteristics of the survey status:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab</span> <span class="n">bgnetto</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_2_2.PNG" src="../_images/aufgabe_2_2.PNG" />
</div>
<p>Respondents with survey status between 10 and 15 or survey status 19 completed the individual questionnaire. Cross-tab the variables bgpop and bgnetto with an appropriate restricting condition to answer the question.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab</span> <span class="n">bgnetto</span> <span class="n">bgpop</span> <span class="k">if</span> <span class="p">((</span><span class="n">bgnetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">bgnetto</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">)</span> <span class="o">|</span> <span class="n">bgnetto</span><span class="o">==</span><span class="mi">19</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bgpop</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="n">bgpop</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_2_3.PNG" src="../_images/aufgabe_2_3.PNG" />
</div>
<p><strong>3. PPFAD allows you to see which populations can be viewed from a longitudinal perspective:</strong></p>
<p><strong>a) How many people who answered the individual questionnaire in 2000 also took part in the survey in 2014?</strong></p>
<p>Remember that the wave-specific survey year in SOEP is abbreviated with letters. SOEP started in 1984 (wave a) and was in a survey wave “bg” in 2016. For more information on the subject, see the subchapter <a class="reference internal" href="../Principles of Data Structure/index.html#label"><span class="std std-ref">Labeling SOEP-Core</span></a>.
The wave name shows that you are interested in the survey years 2000 and 2014. The survey years include the wave names “q”(2000) and “be”(2014). Search the data set for variables with the abbreviations “q” and “be” that describe the survey status. Display the characteristics of the survey status under the condition that the individual questionnaire has been answered:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* a)How many people who answered the personal questionnaire in 2000 also took 
*   part in the survey in 2014?

* informationen from:
*	2000 -&gt; wave q
*  	2014 -&gt; wave be     
* 	Individual questionnaire -&gt; $netto

tab qnetto benetto  if qnetto&gt;=10 &amp; qnetto&lt;=19 &amp; benetto&gt;=10 &amp; benetto&lt;=19
*or:
//fre qnetto benetto  if qnetto&gt;=10 &amp; qnetto&lt;=19 &amp; benetto&gt;=10 &amp; benetto&lt;=19
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_a.PNG" src="../_images/aufgabe_3_a.PNG" />
</div>
<p>A total of 7639 respondents completed the individual questionnaire in 2000 and 2014.</p>
<p><strong>b) How many people answered the individual questionnaire every year from 2000 to 2014?</strong></p>
<p>The survey years include the wave designations from “q”(2000) to “be”(2014).
View the relevant survey status codes to answer the question. Please consider all persons who have answered the individual questionnaire:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* b) How many people answered the individual questionnaire every year from 2000 
*    to 2014?

/* to see all the codes */
lab list bgnetto
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_b.PNG" src="../_images/aufgabe_3_b.PNG" />
</div>
<p>Define a variable list that shows all survey statuses ($netto) of the 15 survey waves considered in total.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">local</span> <span class="n">v</span> <span class="s2">&quot;netto&quot;</span>
<span class="n">local</span> <span class="n">vlist</span> <span class="s2">&quot;q`v&#39; r`v&#39; s`v&#39; t`v&#39; u`v&#39; v`v&#39; w`v&#39; x`v&#39; y`v&#39; z`v&#39; ba`v&#39; bb`v&#39; bc`v&#39; bd`v&#39; be`v&#39;&quot;</span>  
<span class="o">/*</span> <span class="o">--&gt;</span> <span class="mi">15</span> <span class="n">waves</span> <span class="o">*/</span>
</pre></div>
</td></tr></table></div>
<p>Generate a variable that shows the number of waves of completed person interviews. Note that the values 10,12,13,14,15,16,18,19 of the $netto variable mean realized interviews.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>capture drop h1
egen h1 = anycount(`vlist&#39;), values(10 12 13 14 15 16 18 19)
</pre></div>
</td></tr></table></div>
<p>Display a table with its newly generated variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab</span> <span class="n">h1</span> <span class="k">if</span> <span class="n">h1</span> <span class="o">==</span> <span class="mi">15</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_b4.PNG" src="../_images/aufgabe_3_b4.PNG" />
</div>
<p>A total of 6665 people completed the individual questionnaire every year over the period 2000-2014.</p>
<p><strong>c) How many people who turned 15 in 2011 and lived as children in a survey household took part in the survey in 2016?</strong></p>
<p>The survey year 2011 is represented by the wave “bb” and the survey year 2016 is represented by the wave “bg”. To answer the question, a variable must be generated that identifies people who were 15 years old in 2011. The age of the respondent can be determined with the year of birth and you can limit children using the net code. Generate a variable with people who turned 15 in 2011 and lived in a survey household as a child.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* c) How many people who turned 15 in 2011 and lived as children in a survey 
*    household took part in the survey in 2016?

*   informationen from:
*  	2011 -&gt; wave bb
*	Age  -&gt; 15  
*	Child -&gt; bbnetto   
*	2016 -&gt; wave bg
* 	Individual Questionnaire -&gt; bgnetto

/* People who turned 15 in 2011 and lived in a survey household as a child...*/
capture drop a15kind
gen a15kind = 1 if 2011-gebjahr == 15 &amp; bbnetto &gt;= 20 &amp; bbnetto &lt; 30

</pre></div>
</td></tr></table></div>
<p>In order to identify all persons who were 15 years old in 2011, lived in a survey household as a child and completed the individual questionnaire in 2016, you must use the net codes again. Create a table from the net code of 2016 to narrow down the cases appropriately.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">fre</span> <span class="n">bgnetto</span> <span class="k">if</span> <span class="n">a15kind</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="n">bgnetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">bgnetto</span> <span class="o">&lt;</span> <span class="mi">20</span>
<span class="o">*</span> <span class="n">oder</span><span class="p">:</span>
<span class="n">tab</span> <span class="n">bgnetto</span> <span class="k">if</span> <span class="n">a15kind</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="n">bgnetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">bgnetto</span> <span class="o">&lt;</span> <span class="mi">20</span>

</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_c2.PNG" src="../_images/aufgabe_3_c2.PNG" />
</div>
<p>In 2016, a total of 309 people who were 15 years old and were part of a survey household as a child in 2011, completed a individual interview.</p>
<p><strong>d) The person with persnr=588010 was born in 1984 in a panel household and was still part of the sample in 2009. The person has changed households twice during this time. In which years?</strong></p>
<p>To identify how often and when a person has changed the household, you must display all available household numbers in ppfad for person 588010.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* still part of the sample in 2009. The person has changed households twice during
* this time. In which years?

* Information from:
* -&gt; household numbers

list *hhnr if persnr == 588010
/* -&gt; changed household 
 in year d (1987)
 in year y (2008)
 no participation since bb (2011) 
*/
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_d.PNG" src="../_images/aufgabe_3_d.PNG" />
</div>
<p>The person 588010 has participated in the survey since the wave “b” (1985) in household 58807. From wave “d” (1987) to wave “x” (2007) the person was in household 73407, from wave “y” (2008) the person was in household 132608.</p>
</div>
<div class="section" id="generating-a-cross-section-data-set">
<span id="cross-data"></span><h2>Generating a cross-section Data Set<a class="headerlink" href="#generating-a-cross-section-data-set" title="Permalink to this headline">¶</a></h2>
<p>This example involves generating a data set to analyze health satisfaction determinants in 2008, and you can either use the Paneldata.org syntax generator or write your own syntax file to perform this task. You can search for the variable names in Paneldata.org (or use the variables below directly).</p>
<p><strong>1. Generate a cross-section dataset for the year 2008, which should contain all persons with the following characteristics:</strong></p>
<ul class="simple">
<li>Respondents in 2008 <a href="https://paneldata.org/soep-core/data/ppfad/ynetto" target="_blank">"ynetto"</a> </li>
<li>Lives 2008 in private household <a href="https://paneldata.org/soep-core/data/ppfad/ypop" target="_blank">"ypop"</a> </li>
</ul>
<p>The data set should contain the following variables of interest.</p>
<ul class="simple">
<li>Satisfaction with health <a href="https://paneldata.org/soep-core/data/yp/yp0101" target="_blank">"yp0101"</a> </li>
<li>Smoking currently yes/no <a href="https://paneldata.org/soep-core/data/yp/yp10601" target="_blank">"yp10601"</a> </li>
<li>current employment status <a href="https://paneldata.org/soep-core/data/ypgen/emplst08" target="_blank">"emplst08"</a> </li>
<li>monthly household net income <a href="https://paneldata.org/soep-core/data/yhgen/hinc08" target="_blank">"hinc08"</a> </li>
</ul>
<p>In addition, the data set should contain the following additional information for a 2008 cross-sectional analysis (these variables are automatically generated by paneldata.org):</p>
<ul class="simple">
<li>Current cross-section weighting factor <a href="https://paneldata.org/soep-core/data/phrf/yphrf" target="_blank">"yphrf"</a> </li>
<li>Personal number <a href="https://paneldata.org/soep-core/data/ppfad/persnr" target="_blank">"persnr"</a> </li>
<li>Original household number <a href="https://paneldata.org/soep-core/data/ppfad/hhnr" target="_blank">"hhnr"</a> </li>
<li>Current household number <a href="https://paneldata.org/soep-core/data/ppfad/yhhnr" target="_blank">"yhhnr"</a> </li>
<li>Sample affiliation <a href="https://paneldata.org/soep-core/data/ppfad/psample" target="_blank">"psample"</a> </li>
<li>Gender <a href="https://paneldata.org/soep-core/data/ppfad/sex" target="_blank">"sex"</a> </li>
<li>Year of birth <a href="https://paneldata.org/soep-core/data/ppfad/gebjahr" target="_blank">"gebjahr"</a> </li>
</ul>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store commands, log files, data sets and temporary data sets.
Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***********************************************</span>
<span class="o">*</span> <span class="n">Set</span> <span class="n">relative</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span>
<span class="o">***********************************************</span>
<span class="k">global</span> <span class="n">AVZ</span> 	<span class="s2">&quot;H:\material\exercises&quot;</span>
<span class="k">global</span> <span class="n">MY_IN_PATH</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\complete\soep-core\soep.v33.2\stata_en</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_DO_FILES</span> <span class="s2">&quot;$AVZ\do</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_LOG_OUT</span> <span class="s2">&quot;$AVZ\log</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_DATA</span> <span class="s2">&quot;$AVZ\output</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_TEMP</span> <span class="s2">&quot;$AVZ</span><span class="se">\t</span><span class="s2">emp</span><span class="se">\&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p>Use ppfad as the source file together with the required variables. Keep all cases with completed interviews. In addition, your data set should only contain respondents who can make a statement on the content of the question. For example, you can use the net code to identify and remove children from your data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">PFAD</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">use</span> <span class="n">hhnr</span> <span class="n">persnr</span> <span class="n">sex</span> <span class="n">gebjahr</span> <span class="n">psample</span> <span class="n">yhhnr</span> <span class="n">ynetto</span> <span class="n">ypop</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">ppfad.dta&quot;</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">BALANCED</span> <span class="n">VS</span> <span class="n">UNBALANCED</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">keep</span> <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">ynetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">ynetto</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">)</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">PRIATVE</span> <span class="n">VS</span> <span class="n">ALL</span> <span class="n">HOUSEHOLDS</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">keep</span> <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">ypop</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">ypop</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">SORT</span> <span class="n">PFAD</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">ppfad.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>
</pre></div>
</td></tr></table></div>
<p>Save the modified data record temporarily.
Now link your data set with the weights of the SOEP and save your data set as a master file.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">HRF</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">use</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">phrf.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">hrf.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">CREATE</span> <span class="n">MASTER</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">use</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">ppfad.dta&quot;</span>
<span class="n">merge</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">hrf.dta&quot;</span>
<span class="n">drop</span> <span class="k">if</span> <span class="n">_merge</span> <span class="o">==</span> <span class="mi">2</span>
<span class="n">drop</span> <span class="n">_merge</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">master.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>
</pre></div>
</td></tr></table></div>
<p>Now prepare the content variables. Search for the content variables you are looking for from the various data records and temporarily save the created data records.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">READ</span> <span class="n">DATA</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">use</span> <span class="n">hinc08</span> <span class="n">yhhnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">yhgen.dta&quot;</span>
<span class="n">sort</span> <span class="n">yhhnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">yhgen.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>


<span class="n">use</span> <span class="n">yp10601</span> <span class="n">yhhnr</span> <span class="n">yp0101</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">yp.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">yp.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>


<span class="n">use</span> <span class="n">emplst08</span> <span class="n">yhhnr</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">ypgen.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">ypgen.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>
</pre></div>
</td></tr></table></div>
<p>Link your created data sets to your masterfile and save your analysis data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">MERGE</span> <span class="n">DATA</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">use</span>   <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">master.dta&quot;</span>

<span class="n">sort</span> <span class="n">yhhnr</span>
<span class="n">merge</span> <span class="n">yhhnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">yhgen.dta&quot;</span>
<span class="n">drop</span> <span class="k">if</span> <span class="n">_merge</span> <span class="o">==</span> <span class="mi">2</span>
<span class="n">drop</span> <span class="n">_merge</span>

<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">merge</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">yp.dta&quot;</span>
<span class="n">drop</span> <span class="k">if</span> <span class="n">_merge</span> <span class="o">==</span> <span class="mi">2</span>
<span class="n">drop</span> <span class="n">_merge</span>

<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">merge</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_TEMP}</span><span class="s2">ypgen.dta&quot;</span>
<span class="n">drop</span> <span class="k">if</span> <span class="n">_merge</span> <span class="o">==</span> <span class="mi">2</span>
<span class="n">drop</span> <span class="n">_merge</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">DONE</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_DATA}</span><span class="s2">my_dataset.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">desc</span>
</pre></div>
</td></tr></table></div>
<p>You have successfully created a cross-sectional data set for the year 2008.</p>
<p><strong>2. Encode missing values into missing values in system failings (STATA)!</strong></p>
<p>In SOEP the missing codes of variables are described in detail with the values -1 to -8. To learn more about missing codes, see the chapter <a class="reference internal" href="../Principles of Data Structure/index.html#missings"><span class="std std-ref">Missing Conventions</span></a>. For content analyses it is not always necessary to differentiate missing codes. Therefore you should be able to convert missing codes:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span>use &quot;$MY_OUT_DATA\my_dataset.dta&quot;, clear


********************************************************************************
*** Exercise 2) ***
* Encode missing values into missing values in system missings (STATA)!
********************************************************************************

* mvdecode = Change missing values to numeric values and vice versa
	mvdecode _all, mv(-1=. \ -2=.t \ -3=.x \ -5=.y \ -8=.z)
</pre></div>
</td></tr></table></div>
<p>Open your analysis data set and summarize all missing codes.</p>
<p><strong>3. How does average health satisfaction differ</strong>
<strong>a) by sex</strong></p>
<p>Satisfaction was measured on a scale of 10. To compare the average satisfaction with health between women and men, you should display the mean value for both sexes.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">unweighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_06.PNG" src="../_images/quer_06.PNG" />
</div>
<p>Since you have previously added the SOEP weighting factors to your analysis data set, you should use the weighting for a representative analysis.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">weighted</span><span class="o">*</span> 
	<span class="n">tabstat</span> <span class="n">yp0101</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">yphrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span>		
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_07.PNG" src="../_images/quer_07.PNG" />
</div>
<p><strong>b) Employment status</strong></p>
<p>Now proceed in a similar way when comparing satisfaction with health and employment status. Compare the mean values again:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">b</span><span class="p">)</span> <span class="n">by</span> <span class="n">job</span> <span class="n">status</span><span class="p">:</span>
	<span class="o">*</span><span class="n">unweighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">emplst08</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_08.PNG" src="../_images/quer_08.PNG" />
</div>
<p>Since you have previously added the SOEP weighting factors to your analysis data set, you should use the weighting for a representative analysis.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">weighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">yphrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">emplst08</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_09.PNG" src="../_images/quer_09.PNG" />
</div>
<p><strong>c) Age</strong></p>
<p>Since you do not have a variable that represents the age, you must generate a suitable age variable using the Birth year variable. The year of birth is metric and should be categorized for analysis. Define categories for your age variable and assign suitable labels.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">c</span><span class="p">)</span> <span class="n">by</span> <span class="n">age</span> <span class="ow">in</span> <span class="mi">2008</span> <span class="p">(</span><span class="o">&lt;</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="o">-</span><span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="o">+</span><span class="p">)</span>
	
	<span class="n">gen</span> <span class="n">age</span><span class="o">=</span><span class="mi">2008</span><span class="o">-</span><span class="n">gebjahr</span>
	<span class="n">gen</span> <span class="n">age_3</span><span class="o">=</span><span class="n">age</span>
	<span class="n">recode</span> <span class="n">age_3</span> <span class="p">(</span><span class="mi">17</span><span class="o">/</span><span class="mi">29</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">30</span><span class="o">/</span><span class="mi">64</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">65</span><span class="o">/</span><span class="mi">120</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
	<span class="n">label</span> <span class="n">define</span> <span class="n">age_3</span> <span class="mi">1</span> <span class="s2">&quot;17-29&quot;</span> <span class="mi">2</span> <span class="s2">&quot;30-64&quot;</span> <span class="mi">3</span> <span class="s2">&quot;65+&quot;</span>
	<span class="n">label</span> <span class="n">values</span> <span class="n">age_3</span> <span class="n">age_3</span>
</pre></div>
</td></tr></table></div>
<p>Create a mean value comparison with your age variable and health satisfaction in weighted and unweighted form.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">unweighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">age_3</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_11.PNG" src="../_images/quer_11.PNG" />
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">weighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">yphrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">age_3</span><span class="p">)</span> 
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_12.PNG" src="../_images/quer_12.PNG" />
</div>
<p><strong>d) Income</strong></p>
<p>As with age, generate a categorized version of the income for the household net income:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">d</span><span class="p">)</span> <span class="n">by</span> <span class="n">monthly</span> <span class="n">houshold</span> <span class="n">net</span> <span class="n">income</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.999</span><span class="p">,</span> <span class="mf">2.000</span><span class="o">-</span><span class="mf">3.999</span><span class="p">,</span> <span class="mi">4000</span><span class="o">+</span> <span class="n">Euro</span><span class="p">)</span>
	<span class="n">gen</span> <span class="n">hinc08_3</span> <span class="o">=</span> <span class="n">hinc08</span>
	<span class="n">recode</span> <span class="n">hinc08_3</span> <span class="p">(</span><span class="mi">0</span><span class="o">/</span><span class="mi">1999</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="mi">2000</span><span class="o">/</span><span class="mi">3999</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="p">(</span><span class="mi">4000</span><span class="o">/</span><span class="mi">99999</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
	<span class="n">label</span> <span class="n">define</span> <span class="n">hinc08_3</span> <span class="mi">1</span> <span class="s2">&quot;&lt;2000 Euro&quot;</span> <span class="mi">2</span> <span class="s2">&quot;2000-&lt;4000 Euro&quot;</span> <span class="mi">3</span> <span class="s2">&quot;4000+ Euro&quot;</span>
	<span class="n">label</span> <span class="n">values</span> <span class="n">hinc08_3</span> <span class="n">hinc08_3</span>
</pre></div>
</td></tr></table></div>
<p>Display the mean values in weighted and unweighted form:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">unweighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">hinc08_3</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_14.PNG" src="../_images/quer_14.PNG" />
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">weighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">yphrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">hinc08_3</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_15.PNG" src="../_images/quer_15.PNG" />
</div>
<p><strong>e) Smoking</strong></p>
<p>Since this variable is nominal, adjustments to this variable are not necessary. Display the average satisfaction with health for smokers and non-smokers in weighted and unweighted form:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">e</span><span class="p">)</span> <span class="n">by</span> <span class="n">smoking</span> <span class="n">yes</span><span class="o">/</span><span class="n">no</span>

	<span class="o">*</span><span class="n">unweighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">yp10601</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_16.PNG" src="../_images/quer_16.PNG" />
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="o">*</span><span class="n">weighted</span><span class="o">*</span>
	<span class="n">tabstat</span> <span class="n">yp0101</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">yphrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">yp10601</span><span class="p">)</span>  
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/quer_17.PNG" src="../_images/quer_17.PNG" />
</div>
</div>
<div class="section" id="working-with-migration-data-bioimmig">
<h2>Working with Migration Data (BIOIMMIG)<a class="headerlink" href="#working-with-migration-data-bioimmig" title="Permalink to this headline">¶</a></h2>
<p>With its migration and refugee samples, SOEP provides a broad spectrum of information on persons with a refugee and migration background.</p>
<p>In the BIOIMMIG data set you will find relevant information on the history of flight and migration, such as motives for fleeing and migration, the circumstances after arrival in Germany, but also information on relatives in the country of origin and the desire to return to the country of origin in edited form. For more information about this data set and a list of the variables it contains, see the
<a class="reference external" href="http://panel.gsoep.de/soep-docs/surveypapers/diw_ssp0418.pdf#page=214">BIOIMMIG Documentation</a>.</p>
<p>In the following, we will use this record and other information from the SOEP to create a status variable that you can use to distinguish whether or not people with a migration background also have an escape background.</p>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store commands, log files, data sets and temporary data sets.
Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***********************************************</span>
<span class="o">*</span> <span class="n">Set</span> <span class="n">relative</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span>
<span class="o">***********************************************</span>
<span class="k">global</span> <span class="n">AVZ</span> 	<span class="s2">&quot;H:\material\exercises&quot;</span>
<span class="k">global</span> <span class="n">MY_IN_PATH</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\complete\soep-core\soep.v33.2\stata_en</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_DO_FILES</span> <span class="s2">&quot;$AVZ\do</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_LOG_OUT</span> <span class="s2">&quot;$AVZ\log</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_DATA</span> <span class="s2">&quot;$AVZ\output</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_TEMP</span> <span class="s2">&quot;$AVZ</span><span class="se">\t</span><span class="s2">emp</span><span class="se">\&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p><strong>Task 1: Preparation of BIOIMMIG</strong></p>
<p><strong>a) In which variable can you find information about the status of each person when they immigrated to Germany?</strong></p>
<p>Open the record or browse the <a class="reference external" href="http://panel.gsoep.de/soep-docs/surveypapers/diw_ssp0418.pdf#page=214">BIOIMMIG documentation</a> and search for a variable describing the immigration status. The biimgrp variable from the BIOIMMIG data set is the appropriate variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*** Exercise 1 ******************************************************************

/*
a)	In which variable can you find information about the status of each person when they immigrated to Germany?
*/

* Immigration status is stored in the variable biimgrp.

use $MY_IN_PATH\bioimmig.dta, clear
</pre></div>
</td></tr></table></div>
<p><strong>b) Identify this variable in the BIOIMMIG data set and load it from the data set, together with the person number and the survey year.</strong></p>
<p>Open your data set only with the required variables to maintain clarity in your analysis data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
b)	Identify this variable in the BIOIMMIG data set and load it from the data set, together with the person number and the survey year.
*/

use persnr syear biimgrp using $MY_IN_PATH\bioimmig.dta, clear
</pre></div>
</td></tr></table></div>
<p><strong>c) What are the values of this variable?</strong></p>
<p>Familiarize yourself with your research-relevant analysis variable and check coding and case numbers.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
c)	What are the values of this variable? 
*/

tab biimgrp, m //Characteristics of the variable are examined.
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_1.PNG" src="../_images/mig_1.PNG" />
</div>
<p><strong>d) On the basis of this variable, generate the variable “Escape”, which only distinguishes between three groups:</strong></p>
<ul class="simple">
<li>0 = Cases where no information is available</li>
<li>1 = All persons without escape background</li>
<li>2 = Asylum seekers / fugitives</li>
</ul>
<p>After you have familiarized yourself with the research-relevant analysis variable, recode the variable to suit your project. Then check the case numbers of your generated variable with the source variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="n">d</span><span class="p">)</span>	<span class="n">On</span> <span class="n">the</span> <span class="n">basis</span> <span class="n">of</span> <span class="n">this</span> <span class="n">variable</span><span class="p">,</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">variable</span> <span class="s2">&quot;Escape&quot;</span><span class="p">,</span> <span class="n">which</span> <span class="n">only</span> <span class="n">distinguishes</span> <span class="n">between</span> <span class="n">three</span> <span class="n">groups</span><span class="p">:</span>
    <span class="mi">0</span> <span class="o">=</span> <span class="n">Cases</span> <span class="n">where</span> <span class="n">no</span> <span class="n">information</span> <span class="ow">is</span> <span class="n">available</span>
    <span class="mi">1</span> <span class="o">=</span> <span class="n">All</span> <span class="n">persons</span> <span class="n">without</span> <span class="n">escape</span> <span class="n">background</span> 
    <span class="mi">2</span> <span class="o">=</span> <span class="n">Asylum</span> <span class="n">seekers</span> <span class="o">/</span> <span class="n">refugees</span>
<span class="o">*/</span>

<span class="n">recode</span> <span class="n">biimgrp</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span> <span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">1</span> <span class="o">=</span> <span class="mi">0</span> <span class="s2">&quot;No Answer&quot;</span><span class="p">)</span> <span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="o">=</span> <span class="mi">1</span> <span class="s2">&quot;no Escape&quot;</span><span class="p">)</span> <span class="p">(</span><span class="mi">5</span> <span class="o">=</span> <span class="mi">2</span> <span class="s2">&quot;Escape&quot;</span><span class="p">),</span> <span class="n">gen</span><span class="p">(</span><span class="n">Escape</span><span class="p">)</span>
<span class="n">tab</span> <span class="n">biimgrp</span> <span class="n">Escape</span><span class="p">,</span> <span class="n">m</span> <span class="o">//</span> <span class="n">biimgrp</span> <span class="ow">and</span> <span class="n">escape</span> <span class="n">are</span> <span class="n">compared</span><span class="o">.</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_2.PNG" src="../_images/mig_2.PNG" />
</div>
<p><strong>e) It may happen that initially there is no information on the status of immigration, but this will change in a later year. Limit the data record to the last observation that is available for the respective person, since this way the specification with the most information content is used.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">e</span><span class="p">)</span>	<span class="n">It</span> <span class="n">may</span> <span class="n">happen</span> <span class="n">that</span> <span class="n">tinitially</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">information</span> <span class="n">on</span> <span class="n">the</span> <span class="n">status</span> <span class="n">of</span> 
<span class="o">*</span>   <span class="n">immigration</span><span class="p">,</span> <span class="n">but</span> <span class="n">this</span> <span class="n">will</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">later</span> <span class="n">year</span><span class="o">.</span> <span class="n">Limit</span> <span class="n">the</span> <span class="n">data</span> <span class="n">record</span> <span class="n">to</span> 
<span class="o">*</span>   <span class="n">the</span> <span class="n">last</span> <span class="n">observation</span> <span class="n">that</span> <span class="ow">is</span> <span class="n">available</span> <span class="k">for</span> <span class="n">the</span> <span class="n">respective</span> <span class="n">person</span><span class="p">,</span> <span class="n">since</span> <span class="n">this</span> 
<span class="o">*</span>   <span class="n">way</span> <span class="n">the</span> <span class="n">specification</span> <span class="k">with</span> <span class="n">the</span> <span class="n">most</span> <span class="n">information</span> <span class="n">content</span> <span class="ow">is</span> <span class="n">used</span><span class="o">.</span> 
<span class="o">*/</span>

<span class="n">bysort</span> <span class="n">persnr</span><span class="p">:</span> <span class="n">egen</span> <span class="n">syear_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">syear</span><span class="p">)</span> <span class="o">//</span><span class="n">A</span> <span class="n">variable</span> <span class="ow">is</span> <span class="n">created</span><span class="p">,</span> <span class="n">which</span> <span class="n">shows</span> <span class="n">the</span> <span class="n">last</span> <span class="n">existing</span> <span class="n">yearly</span> <span class="n">observation</span>
<span class="n">keep</span> <span class="k">if</span> <span class="n">syear_max</span> <span class="o">==</span> <span class="n">syear</span> <span class="o">//</span><span class="n">Annual</span> <span class="n">observations</span> <span class="n">which</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">the</span> <span class="n">last</span> <span class="n">observation</span> <span class="n">are</span> <span class="n">deleted</span><span class="o">.</span>
</pre></div>
</td></tr></table></div>
<p><strong>f) Save the generated data record on your personal drive temporarily .</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>f)	Save the generated data record on your personal drive temporarily 
*/

save $MY_OUT_TEMP\biimgrp.dta, replace
</pre></div>
</td></tr></table></div>
<p><strong>Aufgabe 2: Add basic variables from PPFAD and weights</strong></p>
<p><strong>a) Load the following information from PPFAD:</strong></p>
<ul class="simple">
<li>Never changing Person ID <a href="https://paneldata.org/soep-core/data/ppfad/persnr" target="_blank">"persnr"</a> </li>
<li>Household number <a href="https://paneldata.org/soep-core/data/ppfad/hhnr" target="_blank">"hhnr"</a>  and the current household number <a href="https://paneldata.org/soep-core/data/ppfad/bghhnr" target="_blank">"bghhnr"</a> </li>
<li>The net variable with information about the interview type <a href="https://paneldata.org/soep-core/data/ppfad/bgnetto" target="_blank">"bgnetto"</a> </li>
<li>The sex of the person <a href="https://paneldata.org/soep-core/data/ppfad/sex" target="_blank">"sex"</a> </li>
<li>The year of birth <a href="https://paneldata.org/soep-core/data/ppfad/gebjahr" target="_blank">"gebjahr"</a> </li>
<li>Variables on the migration background <a href="https://paneldata.org/soep-core/data/ppfad/migback" target="_blank">"migback"</a> , <a href="https://paneldata.org/soep-core/data/ppfad/germborn" target="_blank">"germborn"</a> , <a href="https://paneldata.org/soep-core/data/ppfad/corigin" target="_blank">"corigin"</a> , <a href="https://paneldata.org/soep-core/data/ppfad/immiyear" target="_blank">"immiyear"</a> </li>
<li>Information about the survey status: <a href="https://paneldata.org/soep-core/data/ppfad/psample" target="_blank">"psample"</a> </li>
</ul>
<p>If you want to familiarize yourself with the PPFAD data set, visit the chapter <a class="reference internal" href="#working-ppfad"><span class="std std-ref">Working with Tracking Data (PPFAD)</span></a>.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
a)	Use the following information from PPFAD: 
  - Never changing Person ID „persnr“
  - Household number &quot;hhnr&quot; and the current household number &quot;bghhnr&quot;. 
  - the net variable with information about the interview type &quot;bgnetto&quot;.
  - the sex of the person &quot;sex&quot;
  - the year of birth &quot;semester&quot;
  - Variables on the migration background &quot;migback&quot;, &quot;germborn&quot; &quot;corigin&quot; &quot;immiyear&quot;
  - Information about the survey status: &quot;bgnetto&quot; and &quot;psample&quot;.
*/

use persnr hhnr bghhnr bgnetto psample sex gebjahr germborn corigin immiyear migback  using $MY_IN_PATH\ppfad.dta, clear
</pre></div>
</td></tr></table></div>
<p><strong>b)  Merge the previously generated data record using the person number.</strong></p>
<p>If you don’t understand how to create your own cross-section dataset, visit the chapter <a class="reference internal" href="#cross-data"><span class="std std-ref">Generating a cross-section Data Set</span></a>.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
b)	Merge the previously generated data record using the person number.
*/

merge 1:1 persnr using $MY_OUT_TEMP\biimgrp.dta, nogen
</pre></div>
</td></tr></table></div>
<p><strong>c) Add the corresponding person extrapolation factors to the data record.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>c)	Add the corresponding person extrapolation factors to the data record.
*/

merge 1:1 persnr using $MY_IN_PATH\phrf.dta, keepus(bgphrf) nogen
</pre></div>
</td></tr></table></div>
<p><strong>d) Only keep respondents for whom a youth or individual questionnaire was realized in 2016.</strong></p>
<p>For example, to exclude children who have not provided immigration status information, use the net code from PPFAD. Only keep persons who have conducted a completed individual or youth interview.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="n">d</span><span class="p">)</span>	<span class="n">Only</span> <span class="n">keep</span> <span class="n">individuals</span> <span class="k">for</span> <span class="n">whom</span> <span class="n">a</span> <span class="n">youth</span> <span class="ow">or</span> <span class="n">personal</span> <span class="n">questionnaire</span> <span class="n">was</span> <span class="n">realized</span> <span class="ow">in</span> <span class="mf">2016.</span>
<span class="o">*/</span>

<span class="n">tab</span> <span class="n">bgnetto</span><span class="p">,</span> <span class="n">m</span> <span class="o">//</span><span class="n">Variable</span> <span class="n">values</span> <span class="n">are</span> <span class="n">displayed</span>

<span class="n">keep</span> <span class="k">if</span> <span class="n">inrange</span><span class="p">(</span><span class="n">bgnetto</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span> <span class="o">//</span> <span class="n">People</span> <span class="n">who</span> <span class="n">have</span> <span class="n">a</span> <span class="n">code</span> <span class="n">between</span> <span class="mi">10</span> <span class="ow">and</span> <span class="mi">19</span> <span class="n">will</span> <span class="n">be</span> <span class="n">kept</span><span class="o">.</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_3.PNG" src="../_images/mig_3.PNG" />
</div>
<p><strong>Task 3: Generate a status variable with the following categories:</strong>.</p>
<ul class="simple">
<li>No immigrant background</li>
<li>Migration 2nd generation</li>
<li>Immigration without information</li>
<li>Immigration, not flight</li>
<li>Immigration, Flight</li>
</ul>
<p>To generate this status variable, check the contents of the existing migration variables from PPFAD (migback germborn).</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">/*</span>
<span class="n">Generate</span> <span class="n">a</span> <span class="n">status</span> <span class="n">variable</span> <span class="k">with</span> <span class="n">the</span> <span class="n">following</span> <span class="n">categories</span><span class="p">:</span>
<span class="o">*/</span>

<span class="n">tab</span> <span class="n">migback</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_4.PNG" src="../_images/mig_4.PNG" />
</div>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab</span> <span class="n">germborn</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_5.PNG" src="../_images/mig_5.PNG" />
</div>
<p>Use the migration variables from PPFAD (migback, germborn) and link this information with your previously generated escape variable to build the described status variable from Task 3.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">gen</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">//</span> <span class="n">All</span> <span class="n">persons</span> <span class="n">will</span> <span class="n">first</span> <span class="n">receive</span> <span class="n">the</span> <span class="n">missing</span> <span class="n">code</span> <span class="k">for</span> <span class="s2">&quot;no info&quot;</span><span class="o">.</span>
<span class="n">replace</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">migback</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;</span> <span class="n">germborn</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">//</span> <span class="s2">&quot;no migback&quot;</span>
<span class="n">replace</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">migback</span> <span class="o">==</span> <span class="mi">3</span>                 <span class="o">//</span> <span class="s2">&quot;2nd generation&quot;</span> <span class="p">(</span><span class="mi">2</span><span class="n">nd</span> <span class="n">generation</span> <span class="n">migrants</span> <span class="n">born</span> <span class="n">by</span> <span class="n">definition</span> <span class="ow">in</span> <span class="n">Germany</span><span class="p">,</span> <span class="n">therefore</span> <span class="s2">&quot;&amp; germborn == 1&quot;</span> <span class="n">here</span> <span class="n">unnecessary</span>
<span class="n">replace</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">if</span> <span class="n">germborn</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="n">Escape</span> <span class="o">==</span> <span class="mi">0</span>  <span class="o">//</span> <span class="s2">&quot;Immigrants without information&quot;</span> 
<span class="n">replace</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">4</span> <span class="k">if</span> <span class="n">germborn</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="n">Escape</span> <span class="o">==</span> <span class="mi">1</span>  <span class="o">//</span> <span class="s2">&quot;Immigrants, no escape&quot;</span>
<span class="n">replace</span> <span class="n">Status</span> <span class="o">=</span> <span class="mi">5</span> <span class="k">if</span> <span class="n">germborn</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;</span> <span class="n">Escape</span> <span class="o">==</span> <span class="mi">2</span>  <span class="o">//</span> <span class="s2">&quot;Immigrant, escape&quot;</span>

<span class="n">label</span> <span class="k">def</span> <span class="nf">Statuslbl</span> <span class="mi">0</span><span class="s2">&quot;no info&quot;</span> <span class="mi">1</span><span class="s2">&quot;no migback&quot;</span> <span class="mi">2</span><span class="s2">&quot;2. Generation&quot;</span> <span class="mi">3</span><span class="s2">&quot;Immigrants without information&quot;</span>  <span class="mi">4</span><span class="s2">&quot;Immigrants, no escape&quot;</span> <span class="mi">5</span><span class="s2">&quot;Immigrant, escape&quot;</span>
<span class="n">label</span> <span class="n">val</span> <span class="n">Status</span> <span class="n">Statuslbl</span> <span class="o">//</span> <span class="n">Values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">status</span> <span class="n">veriable</span> <span class="n">receive</span> <span class="n">label</span>
</pre></div>
</td></tr></table></div>
<p><strong>Task 4: Content analysis:</strong></p>
<p><strong>a) How many refugees (foreign-born with refugee/asylum titles) are now in your record?</strong></p>
<p>Look at your status variable previously generated in task 3 to answer the question</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*** Exercise 4 ******************************************************************

/*
a)	How many refugees (foreign-born with refugee/asylum titles) are now in your record?
*/

tab Status, m //Display Generated Status Variable
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_6.PNG" src="../_images/mig_6.PNG" />
</div>
<p>All 4,514 respondents who received the value 5 for the generated status variable have a direct migration background (migback==2), were not born in Germany (germborn==2) and fled their home country (flight==2 and biimgrp==5).</p>
<p><strong>b) How many are there if you take the person extrapolation factors into account? Interpret the results.</strong></p>
<p>Look at your status variable previously generated in task 3 to answer the question</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
b)	How many are there if you take the person extrapolation factors into account? Interpret the results.
*/

tab Status [aw=bgphrf], m  //Display generated status variable weighted with analytic weights
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_7.PNG" src="../_images/mig_7.PNG" />
</div>
<p>After weighting, there are only about 675 fugitives in the data set.
The weighting thus corrected the number of fugitives downwards.</p>
<p><strong>c) How many persons are represented by the sample taking the extrapolation factors into account?</strong></p>
<p>To use frequency weights in STATA, integer weights are required. Create an integer frequency weight from the weighting factor provided so that you can make representative statements. Then take a look at the new results.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
c)	How many persons are represented by the sample taking the extrapolation factors into account?
*/

gen fweight = round(bgphrf) //Frequency weights for stata require integer weight
tab Status [fw=fweight], m  //Display generated status variable weighted with frequency weights
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_8.PNG" src="../_images/mig_8.PNG" />
</div>
<p>Around 1,600,000 people are represented.</p>
<p><strong>d) What is the proportion of people over 40 years of age among the fugitives?</strong></p>
<p>Since the data in this exercise come from the wave “bg”, we are currently in the survey year 2016; if you need a description of the wave designations, please refer to the chapter <a class="reference internal" href="../Principles of Data Structure/index.html#label"><span class="std std-ref">Labeling SOEP-Core</span></a>. To generate a suitable age variable, you can use the year of birth (year of birth). If we look at the survey year 2016, all persons born in 1976 or earlier were over 40 years old. Generate a suitable age variable and look at the proportion of fugitives over 40 years of age in weighted form:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span>/*
d)	What is the proportion of people over 40 years of age among the fugitives?
*/

gen ue_40 = 0
replace ue_40 = 1 if gebjahr &lt;= 1976 // Persons receive proficiency 1 if they were born before 1975.

tab Status ue_40 [aw=bgphrf], m row nofreq
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mig_9.PNG" src="../_images/mig_9.PNG" />
</div>
<p>The proportion of refugees over 40 years of age is about 47%.</p>
</div>
<div class="section" id="generating-a-longitudinal-data-set">
<h2>Generating a longitudinal Data Set<a class="headerlink" href="#generating-a-longitudinal-data-set" title="Permalink to this headline">¶</a></h2>
<p>This example is about generating a data set to analyze determinants of health satisfaction. You can either use the syntax generator of paneldata.org or write a syntax file yourself. You can search for variable names in Paneldata.org.</p>
<p>In the previous examples you have already created an exercise path with four subfolders, as well as corresponding globals in the STATA do-file. You can use the same folders and globals for this exercise.</p>
<p><strong>1.Generate an unbalanced panel dataset for the years 2006 to 2008 using paneldata.org if you wish. The data set should contain all respondents in private households:</strong></p>
<p>The data set should contain the following variables of interest:</p>
<ul class="simple">
<li>Health satisfaction <a href="https://paneldata.org/soep-core/data/wp/wp0101" target="_blank">"wp0101"</a>  <a href="https://paneldata.org/soep-core/data/xp/xp0101" target="_blank">"xp0101"</a>  <a href="https://paneldata.org/soep-core/data/yp/yp0101" target="_blank">"yp0101"</a> </li>
<li>Smoking at present yes/no <a href="https://paneldata.org/soep-core/data/wp/wp9301" target="_blank">"wp9301"</a>  <a href="https://paneldata.org/soep-core/data/yp/yp10601" target="_blank">"yp10601"</a> </li>
<li>Current employment status <a href="https://paneldata.org/soep-core/data/wpgen/emplst06" target="_blank">"emplst06"</a>  <a href="https://paneldata.org/soep-core/data/xpgen/emplst07" target="_blank">"emplst07"</a>  <a href="https://paneldata.org/soep-core/data/ypgen/emplst08" target="_blank">"emplst08"</a> </li>
<li>Monthly household net income <a href="https://paneldata.org/soep-core/data/whgen/hinc06" target="_blank">"hinc06"</a>  <a href="https://paneldata.org/soep-core/data/xhgen/hinc07" target="_blank">"hinc07"</a>  <a href="https://paneldata.org/soep-core/data/yhgen/hinc08" target="_blank">"hinc08"</a> </li>
</ul>
<p>In addition, the data set should include the following additional information for analysis from 2006 to 2008:</p>
<ul class="simple">
<li>Cross-sectional weighting factors for all relevant years <a href="https://paneldata.org/soep-core/data/phrf/wphrf" target="_blank">"wphrf"</a>  <a href="https://paneldata.org/soep-core/data/phrf/xphrf" target="_blank">"xphrf"</a>  <a href="https://paneldata.org/soep-core/data/phrf/yphrf" target="_blank">"yphrf"</a> </li>
<li>Person ID <a href="https://paneldata.org/soep-core/data/ppfad/persnr" target="_blank">"persnr"</a> </li>
<li>Original household number <a href="https://paneldata.org/soep-core/data/ppfad/hhnr" target="_blank">"hhnr"</a> </li>
<li>Household number for all relevant years <a href="https://paneldata.org/soep-core/data/ppfad/whhnr" target="_blank">"whhnr"</a>  <a href="https://paneldata.org/soep-core/data/ppfad/xhhnr" target="_blank">"xhhnr"</a>  <a href="https://paneldata.org/soep-core/data/ppfad/yhhnr" target="_blank">"yhhnr"</a> </li>
<li>Sample membership <a href="https://paneldata.org/soep-core/data/ppfad/psample" target="_blank">"psample"</a> </li>
<li>Sex <a href="https://paneldata.org/soep-core/data/ppfad/sex" target="_blank">"sex"</a> </li>
<li>Year of birth <a href="https://paneldata.org/soep-core/data/ppfad/gebjahr" target="_blank">"gebjahr"</a> </li>
<li>population membership <a href="https://paneldata.org/soep-core/data/ppfad/wpop" target="_blank">"wpop"</a>  <a href="https://paneldata.org/soep-core/data/ppfad/xpop" target="_blank">"xpop"</a>  <a href="https://paneldata.org/soep-core/data/ppfad/ypop" target="_blank">"ypop"</a> </li>
</ul>
<p>If you need detailed instructions on how the script generator works in paneldata.org, you can find them in the chapter
<a class="reference internal" href="../Working with SOEP Documentation/index.html#syntax"><span class="std std-ref">Syntax Generator on paneldata.org</span></a>.</p>
<p>If you would like to assemble your data set yourself, you can do this with the data sets you have supplied. From the previous exercise with tracking data, you may already have an idea where to get most of the variables.</p>
<p>Since we want to have an unbalanced panel record, the $netto variable for the years 2006 to 2008 must also be used. In addition, our analysis must limit population membership, as we are only interested in household respondents.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If a data set is created from several variables of different data sets, it is worth sorting the person number before saving the individual data sets in order to be able to merge the data sets more easily afterwards.</p>
</div>
<p><strong>1.1.  Create a Master-Files</strong></p>
<p>Use ppfad as the source file together with the required variables that you may have already researched in Paneldata or identified from the variable label of the data set. Note that only variables of the years to be analyzed should be used.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
<span class="n">use</span> <span class="n">hhnr</span> <span class="n">persnr</span> <span class="n">sex</span> <span class="n">gebjahr</span> <span class="n">psample</span> <span class="n">xhhnr</span> <span class="n">xnetto</span> <span class="n">xpop</span> <span class="n">yhhnr</span> <span class="n">ynetto</span> <span class="n">ypop</span> <span class="n">whhnr</span> <span class="n">wnetto</span> <span class="n">wpop</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_IN}</span><span class="s2">ppfad.dta&quot;</span>

</pre></div>
</td></tr></table></div>
<p>Since we want to receive an unbalanced data set, i.e. persons who have completed a personal questionnaire at least once within the 3 years, you must restrict the variable $netto (survey status). Also, we only want to analyze private households, so we need a further restriction of the $pop (sample membership) variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
<span class="n">keep</span> <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">xnetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">xnetto</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">ynetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">ynetto</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">wnetto</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="o">&amp;</span> <span class="n">wnetto</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">)</span>


<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">PRIVATE</span> <span class="n">VS</span> <span class="n">ALL</span> <span class="n">HOUSEHOLDS</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>

<span class="n">keep</span> <span class="k">if</span> <span class="p">(</span> <span class="p">(</span><span class="n">xpop</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">xpop</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">ypop</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">ypop</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">wpop</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">|</span> <span class="n">wpop</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">)</span>

</pre></div>
</td></tr></table></div>
<p>Then we sort the persnr (personal number) of the data record and save it.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_OUT}</span><span class="s2">ppfad.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>

</pre></div>
</td></tr></table></div>
<p>What is still missing is the cross-section weighting factor and the variables of interest in terms of content. To apply the weighting factors to the data set, open the weighting data set for the person level phrf, sort it and save it again.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
<span class="n">use</span> <span class="n">persnr</span> <span class="n">wphrf</span> <span class="n">xphrf</span> <span class="n">yphrf</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_IN}</span><span class="s2">phrf.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_OUT}</span><span class="s2">phrf.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>

</pre></div>
</td></tr></table></div>
<p>Now we come to the variables of content. In order not to have to click through all delivered data sets, it is recommended to enter the label of the variable of interest on paneldata.org.</p>
<p>Use the filter to narrow your search. Select our main study SOEP Core, the search type “variable”, the analysis unit “p” or “h” and the corresponding year. Once you have clicked on the year of interest, a variable history is displayed. You can use this to see in which years the variable was collected and what the variable is called.</p>
<p>Example: Variable Label „Satisfaction Health“</p>
<div class="figure align-center">
<img alt="../_images/satisfaction_health.PNG" src="../_images/satisfaction_health.PNG" />
</div>
<p>Example: Variable  Label „currently smoking yes/no“</p>
<div class="figure align-center">
<img alt="../_images/currently_smoke.PNG" src="../_images/currently_smoke.PNG" />
</div>
<p>Example: Variable  Label „current employment status“</p>
<div class="figure align-center">
<img alt="../_images/employment_status.PNG" src="../_images/employment_status.PNG" />
</div>
<p>Example: Variable  Label „monthly net household income“</p>
<div class="figure align-center">
<img alt="../_images/household_income.PNG" src="../_images/household_income.PNG" />
</div>
<p>To merge the data you can either use the script generator on paneldata.org or write the syntax manually into a do-file.</p>
<p>We now have all the information we need to create a master file. As already mentioned with <strong>TIP!</strong>, it is recommended to save the data records sorted by the persnr (person number) before merging.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">persnr</span> <span class="n">wp0101</span> <span class="n">wp9301</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_IN}</span><span class="s2">wp.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_OUT}</span><span class="s2">wp.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>

<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">Persons</span> <span class="mi">2007</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
<span class="n">use</span> <span class="n">persnr</span> <span class="n">xp0101</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_IN}</span><span class="s2">xp.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_OUT}</span><span class="s2">xp.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>

<span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="n">Persons</span> <span class="mi">2008</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
<span class="n">use</span> <span class="n">persnr</span> <span class="n">yp0101</span> <span class="n">yp10601</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_IN}</span><span class="s2">yp.dta&quot;</span>
<span class="n">sort</span> <span class="n">persnr</span>
<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_PATH_OUT}</span><span class="s2">yp.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
<span class="n">clear</span>

</pre></div>
</td></tr></table></div>
<p>With the help of a unique indicator, which is either the household number ($hhnr) or the person number (persnr), you can now merge all data records or individual variables to ppfad. Which indicator to use and when depends on the unit of analysis. Since we are on the person level, our indicator is persnr (person ID).</p>
<p>We load the dataset ppfad and merge our datasets or variables to ppfad.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span>
merge 1:1 persnr using &quot;${MY_PATH_OUT}phrf.dta&quot;, keep(master match) nogen


* merge data from $p.dta 
merge 1:1 persnr using &quot;${MY_PATH_IN}/wp.dta&quot;, keepus(wp0101 wp9301)  keep(master match) nogen // health &amp; smoking
merge 1:1 persnr using &quot;${MY_PATH_IN}/xp.dta&quot;, keepus(xp0101) 		  keep(master match) nogen // health
merge 1:1 persnr using &quot;${MY_PATH_IN}/yp.dta&quot;, keepus(yp0101 yp10601) keep(master match) nogen // health &amp; smoking

* merge data from $pgen.dta 
local y = 6
foreach wave in w x y {
	merge 1:1 persnr using &quot;${MY_PATH_IN}/`wave&#39;pgen.dta&quot;, keepus(emplst0`y&#39;)nogen keep(master match) 
	local y = `y&#39; + 1
}

* merge data from $hgen.dta 
local y = 6
foreach wave in w x y {
	merge m:1 `wave&#39;hhnr using &quot;${MY_PATH_IN}/`wave&#39;hgen.dta&quot;, keepus(hinc0`y&#39;) nogen keep(master match) 
	local y = `y&#39; + 1
}

</pre></div>
</td></tr></table></div>
<p><strong>2. Encode missing values in system failings (STATA)!</strong></p>
<p>After the master file has been created with all required information, the missing values, which can take between -1 to -8 in SOEP, must be recoded into missings. This step is important for converting a wide-format data set to a long format.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>********************************************************************************
*** Task 2) ***
* Encode missing values in system failings (STATA)!
********************************************************************************

	mvdecode _all, mv(-1=. \ -2=.t \ -3=.x \ -5=.y \ -8=.z)
</pre></div>
</td></tr></table></div>
<p><strong>3. The data set is in wide-format, i.e. additional years are displayed as additional variables (columns). For many analyses it makes sense to convert data sets into the long format. In long format, additional years are displayed as additional lines. If the data record covers three years, as in this example, there are three lines for each person. Convert the data set to long format using the STATA command reshape.!</strong></p>
<p>Since these are cross-section variables, it can be assumed that each variable has at least one wave abbreviation, which makes the variable unique. Conversely, this means that the variables must be renamed before the reshape command.</p>
<p>Before renaming all original variables (e.g. from $P data records) it must be checked whether the question and the answer categories were the same in all years (you can also look up the exact wording of the question in the corresponding questionnaire). If changes are made, the variables may have to be recoded.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">Check</span> <span class="k">if</span> <span class="n">original</span> <span class="n">variable</span> <span class="n">have</span> <span class="n">changed</span> <span class="n">over</span> <span class="n">time</span>
	<span class="n">tab1</span> <span class="n">wp0101</span> <span class="n">xp0101</span> <span class="n">yp0101</span>
	<span class="n">tab1</span> <span class="n">wp9301</span> <span class="n">yp10601</span>
	<span class="o">/*</span><span class="n">additionally</span> <span class="n">check</span> <span class="n">questionaires</span> <span class="k">for</span> <span class="n">exact</span> <span class="n">wording</span><span class="o">*/</span>
</pre></div>
</td></tr></table></div>
<p>How you rename the variables is largely up to you. However, you should ensure that the name remains consistent over time and that the variable only differs according to the year (variable name + four-digit year suffix, e.g. zufr2006, zufr2007, zufr2008). You can rename the variables either manually, line by line, or for advanced users using a loop.</p>
<p>Example of manual renaming:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">rename</span> <span class="n">time</span><span class="o">-</span><span class="n">variant</span> <span class="n">variables</span>
<span class="o">*</span><span class="k">with</span> <span class="n">examples</span> <span class="n">how</span> <span class="n">to</span> <span class="n">use</span> <span class="n">loops</span> <span class="p">(</span><span class="n">but</span> <span class="n">can</span> <span class="n">also</span> <span class="n">be</span> <span class="n">done</span> <span class="s2">&quot;manually&quot;</span><span class="p">)</span>
	<span class="n">rename</span> <span class="n">wp9301</span> <span class="n">smoke2006</span>
	<span class="n">rename</span> <span class="n">yp10601</span> <span class="n">smoke2008</span>
	<span class="n">rename</span> <span class="n">wp0101</span> <span class="n">health2006</span>
	<span class="n">rename</span> <span class="n">xp0101</span> <span class="n">health2007</span>
	<span class="n">rename</span> <span class="n">yp0101</span> <span class="n">health2008</span>
	<span class="o">...</span>
</pre></div>
</td></tr></table></div>
<p>Example of a loop:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	foreach  x in 6 7 8 {
		rename hinc0`x&#39; hinc200`x&#39;
		rename emplst0`x&#39; emplst200`x&#39;
		}

		
	local y=2006
	foreach w in w x y {
		rename `w&#39;hhnr hhnrakt`y&#39;
		rename `w&#39;netto netto`y&#39;
		rename `w&#39;pop pop`y&#39;
		rename `w&#39;phrf phrf`y&#39;
		local y=`y&#39;+1
		}
</pre></div>
</td></tr></table></div>
<p><strong>3.1. The reshape-command</strong></p>
<p>Now that we have made all relevant preparations, you can start to convert the data set.
If you want to convert a data set, you can do this in both directions:</p>
<div class="figure align-center">
<img alt="../_images/aufgabe_3_reshape.PNG" src="../_images/aufgabe_3_reshape.PNG" />
</div>
<p>In our case we reshap from wide to long. This means that a new variable name must be assigned for the year of the survey (j). The variable is then generated automatically.  Currently, each person is assigned a line in Stata.</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">persnr</th>
<th class="head">hhnr</th>
<th class="head">wave</th>
<th class="head">sex</th>
<th class="head">smoke2006</th>
<th class="head">smoke2008</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>12345</td>
<td>123</td>
<td>x</td>
<td>m</td>
<td>yes</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>54321</td>
<td>211</td>
<td>x</td>
<td>m</td>
<td>no</td>
<td>no</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">reshape</span> <span class="n">dataset</span> <span class="n">to</span> <span class="n">long</span><span class="o">-</span><span class="nb">format</span>
	<span class="n">reshape</span> <span class="n">long</span> <span class="n">health</span> <span class="n">smoke</span> <span class="n">emplst</span> <span class="n">hinc</span> <span class="n">netto</span> <span class="n">pop</span> <span class="n">hhnrakt</span> <span class="n">phrf</span><span class="p">,</span> <span class="n">i</span><span class="p">(</span><span class="n">persnr</span><span class="p">)</span> <span class="n">j</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
	<span class="n">bys</span> <span class="n">persnr</span><span class="p">:</span> <span class="n">gen</span> <span class="n">waves</span><span class="o">=</span><span class="n">_N</span>		<span class="o">/*</span><span class="n">additional</span> <span class="n">information</span><span class="p">:</span> <span class="n">count</span> <span class="n">number</span> <span class="n">of</span> <span class="n">waves</span> <span class="n">per</span> <span class="n">person</span><span class="o">*/</span>
	<span class="n">tab</span> <span class="n">waves</span>
</pre></div>
</td></tr></table></div>
<p>After the reshape command you have one line per year for each person:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">persnr</th>
<th class="head">hhnr</th>
<th class="head">wave</th>
<th class="head">year</th>
<th class="head">sex</th>
<th class="head">smoke</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>12345</td>
<td>123</td>
<td>x</td>
<td>2006</td>
<td>m</td>
<td>yes</td>
</tr>
<tr class="row-odd"><td>12345</td>
<td>123</td>
<td>y</td>
<td>2007</td>
<td>m</td>
<td>.</td>
</tr>
<tr class="row-even"><td>12345</td>
<td>123</td>
<td>z</td>
<td>2008</td>
<td>m</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p><strong>4. Perform analyses based on the data. Try to answer the following questions:</strong></p>
<p><strong>a. Has average satisfaction with men’s and women’s health changed over the three years?</strong></p>
<p>Satisfaction with health was measured on a scale of 10, with a value of 10 representing an extraordinarily high level of satisfaction. To compare the average satisfaction with health between women and men, you should display the mean value for both sexes. The mean value is displayed weighted here.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*a) Has the average satisfaction with men&#39;s health and women changed 
*   over the three years?

	  mean health [pw=phrf], over(sex year)
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/mean_health.PNG" src="../_images/mean_health.PNG" />
</div>
<p>The output shows the average values for men and women for all three years. The first three values show average satisfaction with men’s health between 2006 and 2008, while the last three values show average satisfaction with women’s health.</p>
<p><strong>b. What is the proportion of people for whom health satisfaction has increased from 2006 to 2007?</strong></p>
<p>To answer this question, the difference between 2006 and 2007 should be displayed. You should make sure that only within one persnr (person ID) and the satisfaction of the following year should be analyzed.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*b) What is the proportion of people for whom health satisfaction has increased 
*   from 2006 to 2007?? 
	sort persnr year
	gen diff=health-health[_n-1] if persnr==persnr[_n-1] &amp; year==year[_n-1]+1
	tab diff if year==2007				/*unweighted*/
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/compare_health_unweighted.PNG" src="../_images/compare_health_unweighted.PNG" />
</div>
<p>Since you have previously added the SOEP weighting factors to your analysis data set, you should use the weighting for a representative analysis.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="n">tab</span> <span class="n">diff</span> <span class="k">if</span> <span class="n">year</span><span class="o">==</span><span class="mi">2007</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">phrf</span><span class="p">]</span>	<span class="o">/*</span><span class="n">weighted</span><span class="o">*/</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/compare_health_weighted.PNG" src="../_images/compare_health_weighted.PNG" />
</div>
<p>The values less than 0 show a deterioration in health satisfaction. The value 0 means a constant health satisfaction and all values above 0 show a positive change in satisfaction with their health. With a value of 10, it can be assumed that these people were interviewed for the first time in 2007 or 2008.</p>
<p><strong>c. In what direction and how much has satisfaction with the health of people who quit smoking after 2006 changed from 2006 to 2008?</strong></p>
<p>The procedure is similar to the previous question, except that the element “smoke yes/no” is added.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*c) In what direction and how much has satisfaction with the health of 
*   people who quit smoking after 2006 changed from 2006 to 2008?

	gen diff2=health-health[_n-2] if persnr==persnr[_n-2] &amp; year==year[_n-2]+2 &amp; year==2008
	gen quit=.
	replace quit=0 if smoke==1 &amp; smoke[_n-2]==1 &amp; persnr==persnr[_n-2] &amp; year==year[_n-2]+2 &amp; year==2008
	replace quit=1 if smoke==2 &amp; smoke[_n-2]==1 &amp; persnr==persnr[_n-2] &amp; year==year[_n-2]+2 &amp; year==2008
	replace quit=2 if smoke==2 &amp; smoke[_n-2]==2 &amp; persnr==persnr[_n-2] &amp; year==year[_n-2]+2 &amp; year==2008
	replace quit=3 if smoke==1 &amp; smoke[_n-2]==2 &amp; persnr==persnr[_n-2] &amp; year==year[_n-2]+2 &amp; year==2008
	label define quit 0 &quot;smoker&quot; 1 &quot;quit&quot; 2 &quot;non-smoker&quot; 3 &quot;begin&quot;
	label values quit quit
	tabstat diff2, by(quit)
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/smoke_vs_health.PNG" src="../_images/smoke_vs_health.PNG" />
</div>
<p>To obtain a weighted mean value, address the analysis weight after the generated variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>	<span class="n">tabstat</span> <span class="n">diff2</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">phrf</span><span class="p">],</span> <span class="n">by</span><span class="p">(</span><span class="n">quit</span><span class="p">)</span>	<span class="o">/*</span><span class="n">weighted</span><span class="o">*/</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/smoke_vs_health_weight.PNG" src="../_images/smoke_vs_health_weight.PNG" />
</div>
<p>This illustration shows the mean of the health variable under the condition of the variable quit we generated beforehand. With a mean of -0.24 (weighted -0.35) the biggest change in health satisfaction is seen in people who quit smoking after 2006. For example, if a person smoked in 2006 and indicated a satisfaction value of 8, the person after he/she stopped smoking in 2008 indicates a satisfaction value of 7.76. So you can assume that when a person stops smoking, the state of health that a person perceives deteriorates. Now we have to test if the assumption is correct.</p>
<p><strong>d. Does quit smoking make your health worse? To what extent can the result of the analysis “Stop smoking” be distorted?</strong></p>
<p>In order to establish a connection between health satisfaction and stopping smoking, one should use the ttest or to be more specific, the one-sample t test. It checks whether the mean value of a sample deviates significantly from a known expected value (specified in the null hypothesis).</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*d) Does quitting smoking make your health worse? To what extent can the 
*   result of the analysis &quot;Stop smoking&quot; be distorted?
	
	* Notes: So far we have not tested whether the difference is statistically significant
		ttest diff2==0 if quit==1 		
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/ttest.PNG" src="../_images/ttest.PNG" />
</div>
<p><em>H0 Hypothesis: If one stops smoking it has no effect on health.</em></p>
<p>For this test we assume a 95% probability. What we want to check now is whether the H0 hypothesis can be rejected or not. If you look at the output of the test, you first see the mean value of value 1 (quit smoking) of the variable quit. The last line of the output shows the significance level. If it falls below the value 0.05, one can speak of a statistically significant result. In our example, the null hypothesis can be discarded because its value is less than 0.05 percent. So quitting smoking has a significant impact on a person’s perceived health.</p>
</div>
<div class="section" id="longitudinal-data-analysis">
<h2>Longitudinal Data Analysis<a class="headerlink" href="#longitudinal-data-analysis" title="Permalink to this headline">¶</a></h2>
<p>Simple cross section analyses show that married people have a higher life satisfaction than singles. You want to check this on the basis of longitudinal analyses with the SOEP.</p>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store your script, log files, datasets and temporary datasets. Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span>***********************************************
* Set some useful commands
***********************************************
version 13
clear all
set more off
**increase buffer size
set scrollbufsize 2000000
**now restart stata!

***********************************************
* Set relative paths to the working directory
***********************************************
global AVZ 	&quot;H:\material\exercises&quot;
global MY_IN_PATH &quot;\\hume\rdc-prod\distribution\soep-long\soep.v33.1\stata_en\&quot;
global MY_DO_FILES &quot;$AVZ\do\&quot;
global MY_LOG_OUT &quot;$AVZ\log\&quot;
global MY_OUT_DATA &quot;$AVZ\output\&quot;
global MY_OUT_TEMP &quot;$AVZ\temp\&quot;
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p><strong>Create a master file that uses the important variables from ppfadl.</strong></p>
<p>You should always add some variables from PPFADL to your data set by default.
Download the following information from PPFADL:</p>
<ul class="simple">
<li>Person ID <a href="https://paneldata.org/soep-long/data/ppfadl/pid" target="_blank">"pid"</a> </li>
<li>Household number <a href="https://paneldata.org/soep-long/data/ppfadl/hid" target="_blank">"hid"</a> </li>
<li>Survey year <a href="https://paneldata.org/soep-long/data/ppfadl/syear" target="_blank">"syear"</a> </li>
<li>The net variable with information on the interview type <a href="https://paneldata.org/soep-long/data/ppfadl/netto" target="_blank">"netto"</a> </li>
<li>The weighting variable <a href="https://paneldata.org/soep-long/data/ppfadl/phrf" target="_blank">"phrf"</a> </li>
<li>The sex of the person <a href="https://paneldata.org/soep-long/data/ppfadl/sex" target="_blank">"sex"</a> </li>
<li>The migration background <a href="https://paneldata.org/soep-long/data/ppfadl/migback" target="_blank">"migback"</a> </li>
</ul>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*-------------------------------------------------------------------------------
*** Step 1) Start with basic information from PPFADL ***

use pid hid syear netto phrf migback sex using ${MY_IN_PATH}\ppfadl.dta 
</pre></div>
</td></tr></table></div>
<p><strong>Search for matching variables and add them to your data set</strong></p>
<p>To perform your analysis, you need different SOEP variables. The SOEP offers various options for a variable search:</p>
<ul class="simple">
<li>Search the questionnaires for useful variables. (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#quest-search"><span class="std std-ref">Variable Search with Questionnaires</span></a>)</li>
<li>Find a suitable variable via the topic list of paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#topic"><span class="std std-ref">Topic Search with paneldata.org</span></a>)</li>
<li>Search for a suitable variable using a search term in paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#var-search"><span class="std std-ref">Variable Search with paneldata.org</span></a>)</li>
<li>Use the documentation provided by the generated variables (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#documentation"><span class="std std-ref">Documentation of Generated Data</span></a>)</li>
</ul>
<p>In this case you need the variables <a href="https://paneldata.org/soep-long/data/pgen/pgfamstd" target="_blank">"pgfamstd"</a>  (martial status) and <a href="https://paneldata.org/soep-long/data/pl/plh0182" target="_blank">"plh0182"</a>  (life satisfaction).</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*-------------------------------------------------------------------------------
*** Step 2) Add the relavant variables: here: family status and life satisfaction ***
merge 1:1 pid syear using ${MY_IN_PATH}\pgen, keepusing(pgfamstd) keep(1 3) nogen	

		// merges family status from pgen
		// Documentation for PGEN can be found here
		// http://panel.gsoep.de/soep-docs/surveypapers/diw_ssp0307.pdf)

		
*describe using pl (directory)
		// for checking out variable names without opening the dataset
		
merge 1:1 pid syear using ${MY_IN_PATH}\pl, keepusing(plh0182) keep(1 3) nogen
		// merges life satisfaction from pl 

save $MY_OUT_DATA\ppfad.dta, replace
</pre></div>
</td></tr></table></div>
<p><strong>Clean and inspect the data</strong></p>
<p>Recode all missings into the format of a point.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*-------------------------------------------------------------------------------</span>
<span class="o">***</span> <span class="n">Step</span> <span class="mi">3</span><span class="p">)</span> <span class="n">Clean</span> <span class="ow">and</span> <span class="n">inspect</span> <span class="n">the</span> <span class="n">data</span>
<span class="n">mvdecode</span> <span class="n">_all</span><span class="p">,</span> <span class="n">mv</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="o">/-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Since you are interested in individual characteristics in your analysis: Delete all measurements that are not based on successful personal interviews.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab</span> <span class="n">netto</span>
<span class="n">drop</span> <span class="k">if</span> <span class="n">netto</span><span class="o">&gt;</span><span class="mi">19</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_01.PNG" src="../_images/SOEPlong_01.PNG" />
</div>
<p><strong>How many people contribute measurements and what is the proportion of people contributing at least 10 measurements?</strong></p>
<p>Define the data set as a panel data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">define</span> <span class="n">the</span> <span class="n">data</span> <span class="nb">set</span> <span class="k">as</span> <span class="n">panel</span> <span class="n">data</span>
<span class="n">xtset</span> <span class="n">pid</span> <span class="n">syear</span>
<span class="n">xtdes</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_02.PNG" src="../_images/SOEPlong_02.PNG" />
</div>
<p>86079 respondents have contributed information within waves a (1984) - bg (2016) and 75% of the 86079 respondents have provided information for at least 10 waves</p>
<p><strong>How many people took part in the survey in 2010 and contributed to continuous measurements until 2014?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">xtdes</span> <span class="k">if</span> <span class="n">syear</span><span class="o">&gt;=</span><span class="mi">2010</span> <span class="o">&amp;</span> <span class="n">syear</span><span class="o">&lt;=</span><span class="mi">2014</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_03.PNG" src="../_images/SOEPlong_03.PNG" />
</div>
<p>14673 respondents provided continuous information from 2010 to 2014.</p>
<p><strong>Univariate inspection &amp; analysis</strong></p>
<p><strong>How does the mean of life satisfaction change over time?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*-------------------------------------------------------------------------------</span>
<span class="o">***</span> <span class="n">Step</span> <span class="mi">4</span><span class="p">)</span> <span class="n">univariate</span> <span class="n">inspection</span> <span class="o">&amp;</span> <span class="n">analysis</span>
<span class="n">table</span> <span class="n">syear</span><span class="p">,</span> <span class="n">content</span> <span class="p">(</span><span class="n">mean</span> <span class="n">plh0182</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_04.PNG" src="../_images/SOEPlong_04.PNG" />
</div>
<p><strong>How high is the proportion of people who will be a) married in 2014 or b) have a migration background. Compare weighted with unweighted frequency tables: Which people are overrepresented in SOEP?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">tab1</span> <span class="n">pgfamstd</span> <span class="n">migback</span> <span class="k">if</span> <span class="n">syear</span><span class="o">==</span><span class="mi">2014</span>
<span class="n">tab</span> <span class="n">pgfamstd</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">phrf</span><span class="p">]</span> <span class="k">if</span> <span class="n">syear</span><span class="o">==</span><span class="mi">2014</span>
<span class="n">tab</span> <span class="n">migback</span> <span class="p">[</span><span class="n">aw</span><span class="o">=</span><span class="n">phrf</span><span class="p">]</span> <span class="k">if</span> <span class="n">syear</span><span class="o">==</span><span class="mi">2014</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_05.PNG" src="../_images/SOEPlong_05.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_06.PNG" src="../_images/SOEPlong_06.PNG" />
</div>
<p>The data show that married people are overrepresented in the SOEP and single people are underrepresented. The weighting makes it representative for Germany again.</p>
<div class="figure align-center">
<img alt="../_images/SOEPlong_05b.PNG" src="../_images/SOEPlong_05b.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_07.PNG" src="../_images/SOEPlong_07.PNG" />
</div>
<p>In the SOEP sample, respondents with a direct or indirect migration background are overrepresented.</p>
<p><strong>How many of those persons who report an life satisfaction (scale value 7) in a survey year also indicate the scale value 7 in the following survey year?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">xttrans</span> <span class="n">plh0182</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_08.PNG" src="../_images/SOEPlong_08.PNG" />
</div>
<p>34.57% of the respondents who reported a life satisfaction of 7 again reported a value of 7 in the following year.</p>
<p><strong>Is it more likely that a highly dissatisfied person (value: 0) will be less dissatisfied the following year, or that a very satisfied (value: 10) person will be less satisfied the following year?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">xttrans</span> <span class="n">plh0182</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_08.PNG" src="../_images/SOEPlong_08.PNG" />
</div>
<p>The rows reflect the initial values, and the columns reflect the final values.
People who were completely dissatisfied (value: 0) in the base year remain completely dissatisfied with around 20 % in the following year. About 80% of these dissatisfied people from the base year improve their life satisfaction in the following year. Of the completely satisfied persons (value: 10), about 37% remain just as satisfied in the following year. For 63%, however, life satisfaction worsens. It is more likely that a completely dissatisfied person (value: 0) will become more satisfied in the following year.</p>
<p><strong>Which transitions in marital status can be observed particularly frequently in the data?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">xttrans</span> <span class="n">pgfamstd</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_09.PNG" src="../_images/SOEPlong_09.PNG" />
</div>
<p>Survey respondents who were married but separated in the base year and declared a divorce as family status in the following year can be observed particularly frequently. (About 19%).</p>
<p><strong>Simple cross sectional analyses</strong></p>
<p>You now want to discover the correlation between marital status and life satisfaction. Is there an effect of marriage on life satisfaction? And if so, is this a sustainable effect?</p>
<p><strong>First, calculate the correlation between family status and life satisfaction in cross section for 2010: Are married people happier than singles?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*-------------------------------------------------------------------------------</span>
<span class="o">***</span> <span class="n">Step</span> <span class="mi">5</span><span class="p">)</span><span class="n">simple</span> <span class="n">cross</span> <span class="n">sectional</span> <span class="n">analyses</span>
<span class="n">table</span> <span class="n">pgfamstd</span> <span class="k">if</span> <span class="n">syear</span><span class="o">==</span><span class="mi">2010</span><span class="p">,</span> <span class="n">content</span> <span class="p">(</span><span class="n">mean</span> <span class="n">plh0182</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_10.PNG" src="../_images/SOEPlong_10.PNG" />
</div>
<p>At first glance, married couples seem happier than singles.</p>
<p>Now generate a variable that indicates a transition from “single” to “married”.</p>
<p><strong>How many such transitions can you find in the data?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***</span><span class="n">perform</span> <span class="n">longitudinal</span> <span class="n">analysis</span>
<span class="o">**</span><span class="n">define</span> <span class="n">event</span><span class="p">:</span> <span class="n">transition</span> <span class="n">to</span> <span class="n">marriage</span>	
<span class="n">generate</span> <span class="n">to_mar</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">pgfamstd</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l</span><span class="o">.</span><span class="n">pgfamstd</span><span class="o">==</span><span class="mi">3</span>
<span class="n">tab</span> <span class="n">to_mar</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_11.PNG" src="../_images/SOEPlong_11.PNG" />
</div>
<p>A total of 4834 people can be observed changing from single to married.</p>
<p><strong>What is the average level of life satisfaction immediately after the transition to marriage (i.e. in the first survey in which the transition can be observed) and how high is life satisfaction immediately before the transition to marriage?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">standard</span> <span class="n">way</span> <span class="n">of</span> <span class="n">life</span><span class="o">-</span><span class="n">event</span> <span class="n">analysis</span>
<span class="nb">sum</span> <span class="n">plh0182</span> <span class="k">if</span> <span class="n">to_mar</span><span class="o">==</span><span class="mi">1</span>
<span class="nb">sum</span> <span class="n">l</span><span class="o">.</span><span class="n">plh0182</span> <span class="k">if</span> <span class="n">to_mar</span><span class="o">==</span><span class="mi">1</span>

<span class="o">**</span><span class="n">alternative</span> <span class="n">way</span>
<span class="n">generate</span> <span class="n">dif_sat</span><span class="o">=</span> <span class="n">plh0182</span><span class="o">-</span> <span class="n">l</span><span class="o">.</span><span class="n">plh0182</span>
<span class="n">mean</span> <span class="n">dif_sat</span> <span class="k">if</span> <span class="n">to_mar</span><span class="o">==</span><span class="mi">1</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_12.PNG" src="../_images/SOEPlong_12.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_13.PNG" src="../_images/SOEPlong_13.PNG" />
</div>
<p>Before the transition to marriage, the average life satisfaction of the respondents is 7.54. in the following year, i.e. after the transition to marriage, the average life satisfaction of the respondents is 7.65. It can be seen that with the transition to marriage, the average life satisfaction rises slightly by 0.11.</p>
<p><strong>Map the complete satisfaction history around the “marriage entry” event [3 years before; 3 years after].</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">preparing</span> <span class="n">illustration</span> <span class="n">of</span> <span class="n">trajectory</span>
<span class="n">generate</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">to_mar</span><span class="o">==</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span><span class="n">l2</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l3</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l4</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l5</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l6</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l7</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l8</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l9</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l10</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l11</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l12</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l13</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">l14</span><span class="o">.</span><span class="n">to_mar</span><span class="o">~=</span><span class="mi">1</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">l2</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=</span><span class="mi">3</span> <span class="k">if</span> <span class="n">l3</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=-</span><span class="mi">2</span> <span class="k">if</span> <span class="n">f2</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>
<span class="n">replace</span> <span class="n">t</span><span class="o">=-</span><span class="mi">3</span> <span class="k">if</span> <span class="n">f3</span><span class="o">.</span><span class="n">t</span><span class="o">==</span><span class="mi">0</span>

<span class="n">table</span> <span class="n">t</span><span class="p">,</span> <span class="n">content</span> <span class="p">(</span><span class="n">mean</span> <span class="n">plh0182</span> <span class="n">n</span> <span class="n">plh0182</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_14.PNG" src="../_images/SOEPlong_14.PNG" />
</div>
<p>Choose a suitable presentation for your results and let Stata create a graphic.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span>** Preparing graph of event analysis												
sort t
cap drop meanplh0182
by t: egen meanplh0182 = mean(plh0182)

cap drop upper
gen upper = .
forval i = -3/3{ 
	su plh0182 if t == `i&#39;
	replace upper = r(mean) + 1.96 * r(sd)/sqrt(r(N)) if t == `i&#39;
}

cap drop lower
gen lower = .
forval i = -3/3{ 
	su plh0182 if t == `i&#39;
	replace lower = r(mean) - 1.96 * r(sd)/sqrt(r(N)) if t == `i&#39;
}

twoway (line meanplh0182 t) (rcap upper lower t, lcolor(&quot;red&quot;)) , title(&quot;Satisfaction with life relative to year of marriage&quot;) legend(label(1 &quot;Avg. life satisfaction&quot;) label(2 &quot;95% Conf. interval&quot;)) scheme(s1mono) xtitle(&quot;Years relative to marriage&quot;) ytitle(&quot;Avg. life satisfaction&quot;)
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/SOEPlong_15.PNG" src="../_images/SOEPlong_15.PNG" />
</div>
<p>The graph shows that a positive effect on life satisfaction can be observed when the family status changes from single to married. In the following years of the existing marriage, life satisfaction decreases again and approaches the initial satisfaction before the marriage.</p>
</div>
<div class="section" id="fixed-effects-estimation">
<h2>Fixed Effects Estimation<a class="headerlink" href="#fixed-effects-estimation" title="Permalink to this headline">¶</a></h2>
<p>You want to find out whether certain variables relevant to the labour market, such as work experience or education time, influence a person’s hourly wage. Other variables such as gender or marriage status should also be taken into account. You decide to use the SOEP data to set up a fixed effects estimation model.</p>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store your script, log files, datasets and temporary datasets. Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***********************************************</span>
<span class="o">*</span> <span class="n">Set</span> <span class="n">relative</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span>
<span class="o">***********************************************</span>
<span class="k">global</span> <span class="n">AVZ</span> 	<span class="s2">&quot;H:\material\exercises&quot;</span>
<span class="k">global</span> <span class="n">MY_IN_PATH</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\distribution\soep-long\soep.v33.1\stata_en</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_DO_FILES</span> <span class="s2">&quot;$AVZ\do</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_LOG_OUT</span> <span class="s2">&quot;$AVZ\log</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_DATA</span> <span class="s2">&quot;$AVZ\output</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_TEMP</span> <span class="s2">&quot;$AVZ</span><span class="se">\t</span><span class="s2">emp</span><span class="se">\&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p><strong>a) Generate your own SOEPWage.dta data set. The data set should contain information on gross monthly wage, marital status and other personal characteristics.</strong></p>
<p>To perform your analysis, you need different SOEP variables. The SOEP offers various options for a variable search:</p>
<ul class="simple">
<li>Search the questionnaires for useful variables. (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#quest-search"><span class="std std-ref">Variable Search with Questionnaires</span></a>)</li>
<li>Find a suitable variable via the topic list of paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#topic"><span class="std std-ref">Topic Search with paneldata.org</span></a>)</li>
<li>Search for a suitable variable using a search term in paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#var-search"><span class="std std-ref">Variable Search with paneldata.org</span></a>)</li>
<li>Use the documentation provided by the generated variables (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#documentation"><span class="std std-ref">Documentation of Generated Data</span></a>)</li>
</ul>
<p>Use the various important variables of the ppfadl.dta data set as your start file. Your source file should contain the following variables:</p>
<ul class="simple">
<li>Person ID <a href="https://paneldata.org/soep-long/data/ppfadl/pid" target="_blank">"pid"</a> </li>
<li>Survey year <a href="https://paneldata.org/soep-long/data/ppfadl/syear" target="_blank">"syear"</a> </li>
<li>Birth Year <a href="https://paneldata.org/soep-long/data/ppfadl/gebjahr" target="_blank">"gebjahr"</a> </li>
<li>The net variable with information on the interview type <a href="https://paneldata.org/soep-long/data/ppfadl/netto" target="_blank">"netto"</a> </li>
<li>The weighting variable <a href="https://paneldata.org/soep-long/data/ppfadl/phrf" target="_blank">"phrf"</a> </li>
<li>The sex of the person <a href="https://paneldata.org/soep-long/data/ppfadl/sex" target="_blank">"sex"</a> </li>
<li>Sample Membership <a href="https://paneldata.org/soep-long/data/ppfadl/pop" target="_blank">"pop"</a> </li>
</ul>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">pid</span> <span class="n">syear</span> <span class="n">sex</span> <span class="n">gebjahr</span> <span class="n">netto</span> <span class="n">pop</span> <span class="n">phrf</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">/ppfadl.dta&quot;</span><span class="p">,</span> <span class="n">clear</span>
</pre></div>
</td></tr></table></div>
<p>Apply the necessary content variables to your starting data set. You need the following variables for your analysis:</p>
<ul class="simple">
<li>Employment Status <a href="https://paneldata.org/soep-long/data/pl/plb0022 " target="_blank">"plb0022"</a> </li>
<li>Current Gross Labor Income in Euro <a href="https://paneldata.org/soep-long/data/pgen/pglabgro " target="_blank">"pglabgro"</a> </li>
<li>Actual Work Time Per Week <a href="https://paneldata.org/soep-long/data/pgen/pglabgro " target="_blank">"pgtatzeit"</a> </li>
<li>Working Experience Full-Time Employment <a href="https://paneldata.org/soep-long/data/pgen/pgexpft  " target="_blank">"pgexpft"</a> </li>
<li>Amount Of Education Or Training In Years <a href="https://paneldata.org/soep-long/data/pgen/pgbilzeit  " target="_blank">"pgbilzeit"</a> </li>
<li>Marital Status In Survey Year <a href="https://paneldata.org/soep-long/data/pgen/pgfamstd" target="_blank">"pgfamstd"</a> </li>
</ul>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">merge</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span> <span class="n">pid</span> <span class="n">syear</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">/pl.dta&quot;</span><span class="p">,</span> <span class="n">keepus</span><span class="p">(</span><span class="n">plb0022</span><span class="p">)</span> <span class="n">keep</span><span class="p">(</span><span class="n">master</span> <span class="n">match</span><span class="p">)</span> <span class="n">nogen</span>
<span class="n">merge</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span> <span class="n">pid</span> <span class="n">syear</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH}</span><span class="s2">/pgen.dta&quot;</span><span class="p">,</span> <span class="n">keepus</span><span class="p">(</span><span class="n">pglabgro</span> <span class="n">pgtatzeit</span> <span class="n">pgexpft</span> <span class="n">pgbilzeit</span> <span class="n">pgfamstd</span><span class="p">)</span> <span class="n">keep</span><span class="p">(</span><span class="n">master</span> <span class="n">match</span><span class="p">)</span> <span class="n">nogen</span>
</pre></div>
</td></tr></table></div>
<p>Only keep people who have completed an interview and who live in a private household.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Only</span> <span class="n">select</span> <span class="n">people</span> <span class="k">with</span> <span class="n">completed</span> <span class="n">interviews</span>
<span class="n">keep</span> <span class="k">if</span> <span class="n">inrange</span><span class="p">(</span><span class="n">netto</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>

<span class="o">*</span> <span class="n">Only</span> <span class="n">private</span> <span class="n">households</span>
<span class="n">keep</span> <span class="k">if</span> <span class="n">pop</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="n">pop</span><span class="o">==</span><span class="mi">2</span>
</pre></div>
</td></tr></table></div>
<p>Since you are only interested in the period from 2012 to 2016 in your analysis, remove all survey information that does not fall within this period. To finish, save your data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Period</span> <span class="kn">from</span> <span class="mi">2012</span> <span class="n">to</span> <span class="mi">2016</span>
<span class="n">keep</span> <span class="k">if</span> <span class="n">syear</span><span class="o">&gt;=</span><span class="mi">2012</span> <span class="o">&amp;</span> <span class="n">syear</span><span class="o">&lt;=</span><span class="mi">2016</span>
</pre></div>
</td></tr></table></div>
<p><strong>Exercise 1: Prepare your data set</strong></p>
<p><strong>a) Load your created SOEPWage.dta data set. The data set contains information on gross monthly wage, marital status and other personal characteristics.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Exercise</span> <span class="mi">1</span><span class="p">:</span> <span class="n">Prepare</span> <span class="n">your</span> <span class="n">data</span> <span class="nb">set</span>
<span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="n">Load</span> <span class="n">data</span> <span class="nb">set</span>
<span class="n">use</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_DATA}</span><span class="s2">/SOEPWage.dta&quot;</span><span class="p">,</span> <span class="n">clear</span>
</pre></div>
</td></tr></table></div>
<p><strong>b) Recode all missing values in Stata Missings (.)</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="n">Recode</span> <span class="n">Missings</span>
<span class="n">mvdecode</span> <span class="n">_all</span><span class="p">,</span> <span class="n">mv</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="o">/-</span><span class="mi">1</span> <span class="o">=</span> <span class="o">.</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>For more information about the missing codes of SOEP data visit the chapter <a class="reference internal" href="../Principles of Data Structure/index.html#missings"><span class="std std-ref">Missing Conventions</span></a></p>
<p><strong>c) Generate the variables “hourly wage” (gross monthly wage/4.33*working time) for persons who have earned at least 1 Euro and have worked at least one hour,  “Married vs. Unmarried” and age.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="n">Generate</span> <span class="n">Variables</span>
<span class="n">gen</span> <span class="n">wage</span> <span class="o">=</span> <span class="n">pglabgro</span><span class="o">/</span><span class="p">(</span><span class="mf">4.33</span><span class="o">*</span><span class="n">pgtatzeit</span><span class="p">)</span> <span class="k">if</span> <span class="n">pglabgro</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="o">&amp;</span> <span class="n">pgtatzeit</span><span class="o">&gt;=</span><span class="mi">1</span>

<span class="n">gen</span> <span class="n">married</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">pgfamstd</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="n">pgfamstd</span><span class="o">==</span><span class="mi">6</span> <span class="o">|</span> <span class="n">pgfamstd</span><span class="o">==</span><span class="mi">7</span> <span class="o">|</span> <span class="n">pgfamstd</span><span class="o">==</span><span class="mi">8</span>
<span class="n">replace</span> <span class="n">married</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">inrange</span><span class="p">(</span><span class="n">pgfamstd</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">gen</span> <span class="n">age</span> <span class="o">=</span> <span class="n">syear</span> <span class="o">-</span> <span class="n">gebjahr</span>
</pre></div>
</td></tr></table></div>
<p><strong>d) Adjust the variable “hourly wage” from outlier values by setting values smaller than the 1st percentile to the same value. Set values greater than 3 times the 99th percentile to 3*99th percentile. Then generate the variable lwage = log(wage).</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">d</span><span class="p">)</span> <span class="n">Adjust</span> <span class="n">wage</span> <span class="n">variable</span>
<span class="nb">sum</span> <span class="n">wage</span><span class="p">,</span> <span class="n">detail</span>
<span class="n">replace</span> <span class="n">wage</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span> <span class="k">if</span> <span class="n">wage</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="n">replace</span> <span class="n">wage</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">p99</span><span class="p">)</span> <span class="k">if</span> <span class="n">wage</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">p99</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">wage</span><span class="o">&lt;.</span>

<span class="n">gen</span> <span class="n">lwage</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span>
<span class="n">label</span> <span class="n">variable</span> <span class="n">lwage</span> <span class="s2">&quot;Log hourly wage&quot;</span>

<span class="n">save</span> <span class="s2">&quot;$</span><span class="si">{MY_OUT_DATA}</span><span class="s2">/SOEPWage_temp.dta&quot;</span><span class="p">,</span> <span class="n">replace</span>
</pre></div>
</td></tr></table></div>
<p><strong>Exercise 2: Descriptive statistics</strong></p>
<p><strong>a) Define the data set as a panel data set.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Exercise</span> <span class="mi">2</span><span class="p">:</span> <span class="n">Descriptive</span> <span class="n">statistics</span>
<span class="o">*</span> <span class="n">a</span><span class="p">)</span>
<span class="n">xtset</span> <span class="n">pid</span> <span class="n">syear</span> <span class="o">//</span> <span class="n">Declaring</span> <span class="n">data</span> <span class="k">as</span> <span class="n">panel</span> <span class="n">data</span>
</pre></div>
</td></tr></table></div>
<p><strong>b) What percentage of people participate in all five waves (xtdescribe)</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">b</span><span class="p">)</span>
<span class="n">xtdescribe</span><span class="p">,</span> <span class="n">patterns</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">//</span> <span class="o">-&gt;</span> <span class="n">unbalanced</span> <span class="n">panel</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_01.PNG" src="../_images/fixed_01.PNG" />
</div>
<p>42808 respondents have contributed information within waves bc (2012) - bg (2016) and about 40% (17069) of the 42808 respondents have provided information for all waves.</p>
<p><strong>c) Describe the variable “Married” with xttab and xttrans. Take a look at some individual wage (pid=30320901, pid=30932501, pid==3101602, pid==3101801) developments with xtline.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">c</span><span class="p">)</span> 
<span class="o">*</span> <span class="n">Stability</span> <span class="n">of</span> <span class="n">the</span> <span class="n">relationship</span> <span class="n">status</span>
<span class="n">xttab</span> <span class="n">married</span> 
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_02.PNG" src="../_images/fixed_02.PNG" />
</div>
<p>You can observe 41.37 percent of person-year observations with Married==No. At least once 19717 people within the period from 2012 to 2016 have stated not to have been married. 25014 persons reported to have been married at least once during this period. Those who were not married for at least one year responded with “married==no” in 94.69% of the observations. Whereas those who have been married at least once responded in 95.88 percent of the observations with”Married==Yes”. A very stable response behaviour can therefore be observed.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Transition</span> <span class="n">probabilities</span>
<span class="n">xttrans</span> <span class="n">married</span><span class="p">,</span> <span class="n">freq</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_03.PNG" src="../_images/fixed_03.PNG" />
</div>
<p>96.87 percent of the person-year observations with “married==no” are also not yet married in the next period. 98.51 percent of the persons who are married indicate that they will also be married in the following period. A stable behaviour of the respondents can be seen.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Individual</span> <span class="n">sequences</span> <span class="n">of</span> <span class="s2">&quot;wage&quot;</span>
<span class="n">xtline</span> <span class="n">wage</span> <span class="k">if</span> <span class="n">pid</span><span class="o">==</span><span class="mi">30320901</span> <span class="o">|</span> <span class="n">pid</span><span class="o">==</span><span class="mi">30932501</span> <span class="o">|</span> <span class="n">pid</span><span class="o">==</span><span class="mi">3101602</span> <span class="o">|</span> <span class="n">pid</span><span class="o">==</span><span class="mi">3101801</span><span class="p">,</span> <span class="n">overlay</span> 
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_04.PNG" src="../_images/fixed_04.PNG" />
</div>
<p>The graphic shows a comparison of the hourly wage for four different respondents.</p>
<p><strong>Exercise 3: Pooled OLS Regression</strong></p>
<p><strong>a) Execute a pooled OLS regression with “Log hourly wage” as dependent variable and “Married”, “Gender”, “Work experience” and “Training time” as independent variables. Interpret the coefficients for “married”, “gender” and “length of training”. Why are these not causal effects?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="n">Exercise</span> <span class="mi">3</span><span class="p">:</span> <span class="n">Pooled</span> <span class="n">OLS</span> <span class="n">Regression</span>
<span class="o">*</span> <span class="n">a</span><span class="p">)</span> <span class="n">Pooled</span> <span class="n">OLS</span>
<span class="n">reg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">sex</span> <span class="n">pgexpft</span> <span class="n">pgbilzeit</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_05.PNG" src="../_images/fixed_05.PNG" />
</div>
<p>The variables married, sex and pgbilzeit most likely correlate with
other disregarded/unobserved variables that have an effect on the wage. For example, women work more frequently in occupations with lower wages.</p>
<p><strong>b) Run the regression again with the option “vce(cluster persnr)” to get clustered standard errors. How do the standard errors of the coefficients change?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="n">Pooled</span> <span class="n">OLS</span> <span class="k">with</span> <span class="n">cluster</span> <span class="n">standard</span> <span class="n">errors</span>
<span class="n">reg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">sex</span> <span class="n">pgexpft</span> <span class="n">pgbilzeit</span><span class="p">,</span> <span class="n">vce</span><span class="p">(</span><span class="n">cluster</span> <span class="n">pid</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_06.PNG" src="../_images/fixed_06.PNG" />
</div>
<p>The standard errors are getting bigger.</p>
<p><strong>Exercise 4: Fixed Effects</strong></p>
<p><strong>a) Subtract the person-specific mean value from each variable of the model. Use the “egen” function. Ideally you should also use a loop.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span>*** Exercise 4: Fixed Effects
* a) Subtract person-specific averages

gen sample = 1
foreach var in lwage married sex pgexpft pgbilzeit {

	bysort pid: egen `var&#39;Mean = mean(`var&#39;)
	replace `var&#39;Mean = . if `var&#39;==.
	gen `var&#39;Demeaned =  `var&#39; - `var&#39;Mean
	replace sample = 0 if `var&#39;==.
}
bysort pid (sample): replace sample = sample[1]
</pre></div>
</td></tr></table></div>
<p><strong>b) Estimate the Fixed Effects model with the previously generated variables. Why is no coefficient estimated for “gender”? How do the coefficients change compared to the pooled OLS estimate? Is the effect of “married” now causally interpretable?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">reg</span> <span class="n">lwageDemeaned</span> <span class="n">marriedDemeaned</span> <span class="n">sexDemeaned</span> <span class="n">pgexpftDemeaned</span> <span class="n">pgbilzeitDemeaned</span><span class="p">,</span> <span class="n">vce</span><span class="p">(</span><span class="n">cluster</span> <span class="n">pid</span><span class="p">)</span> <span class="n">nocons</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_07.PNG" src="../_images/fixed_07.PNG" />
</div>
<p>No coefficient was estimated for sex because sex was stable over time for all observations. The coefficient of married is now significant at the 5% level!</p>
<p><strong>c) Now estimate the Fixed Effects model using the command
“xtreg lwage married sex pgexpft pgbilzeit, fe “. What do you notice about the coefficients compared to task 4 b)? And with the standard errors?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">c</span><span class="p">)</span> <span class="n">xtreg</span><span class="p">,</span> <span class="n">fe</span>
<span class="n">xtreg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">pgexpft</span> <span class="n">pgbilzeit</span><span class="p">,</span> <span class="n">fe</span> <span class="n">vce</span><span class="p">(</span><span class="n">cluster</span> <span class="n">pid</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_08.PNG" src="../_images/fixed_08.PNG" />
</div>
<p>The coefficients are not identical with 4 b) and the standard errors become larger, because model b) does not take into account the estimation of mean values in the standard errors.</p>
<p><strong>d) Now add dummy variables for the years (i.syear). What happens with the effect of “labour market experience”?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">d</span><span class="p">)</span> <span class="n">xtreg</span> <span class="k">with</span> <span class="n">dummy</span>
<span class="n">xtreg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">pgexpft</span> <span class="n">pgbilzeit</span> <span class="n">i</span><span class="o">.</span><span class="n">syear</span><span class="p">,</span> <span class="n">fe</span> <span class="n">vce</span><span class="p">(</span><span class="n">cluster</span> <span class="n">pid</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_09.PNG" src="../_images/fixed_09.PNG" />
</div>
<p>Effects on the variables remain significant. The model could possibly be specified on a case by case basis. The Mincer equation is based on (potential) labour market experience squared.</p>
<p><strong>e) Now you can also square labour market experience into the model. To what extent does the effect of labour market experience change compared to task 5d)?</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">e</span><span class="p">)</span> <span class="n">expft</span> <span class="n">squared</span>
<span class="n">xtreg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">c</span><span class="o">.</span><span class="n">pgexpft</span><span class="c1">##c.pgexpft pgbilzeit i.syear, fe vce(cluster pid)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_10.PNG" src="../_images/fixed_10.PNG" />
</div>
<p>The coefficients of pgexpft and pgexpft^2 remain significant whereas the coefficient for married is no longer significant.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">graph</span> <span class="n">twoway</span> <span class="p">(</span><span class="n">func</span> <span class="n">y</span> <span class="o">=</span> <span class="n">_b</span><span class="p">[</span><span class="n">pgexpft</span><span class="p">]</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">_b</span><span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">pgexpft</span><span class="c1">#c.pgexpft]*x*x, range(0 40))</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_11.PNG" src="../_images/fixed_11.PNG" />
</div>
<p>The graph shows that the effects of the labour market experience decrease after approximately 15 years of professional experience.</p>
<p><strong>f) Now estimate the model from task 5e) with longitudinal section weights. Why is the number of cases now significantly smaller? Why could the coefficient of “pgbilzeit” have changed?</strong></p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">Create your own longitudinal person weights  e.g. longitudinal person weight from wave A to wave D. Take the starting wave cross-sectional weight (aphrf) and multiply through by each following wave staying factor, as in the following example:
gen adphrf=aphrf*bpbleib*cpbleib*dpbleib</p>
</div>
<p>Since you are looking at the period 2012-2016, you must create a suitable longitudinal weight. To do this, use the phrf data set from the RAW subdirectory. Apply the required variables on your analysis data set and generate your period-related longitudinal section weight. To understand the structure of the data distribution file and the location of the different data sets, visit the chapter <a class="reference internal" href="../Principles of Data Structure/index.html#datasets"><span class="std std-ref">Data Sets SOEP-Core</span></a>. For more information about the weighting data sets and other survey data sets, visit the chapter <a class="reference internal" href="../Principles of Data Structure/index.html#survey"><span class="std std-ref">Survey Data</span></a>.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">f</span><span class="p">)</span> <span class="n">Fixed</span> <span class="n">Effects</span> <span class="n">weighted</span>
<span class="k">global</span> <span class="n">MY_IN_PATH2</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\complete\soep-core\soep.v33.2\stata_en</span><span class="se">\&quot;</span>
<span class="n">rename</span> <span class="n">pid</span> <span class="n">persnr</span>
<span class="n">merge</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span> <span class="n">persnr</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_IN_PATH2}</span><span class="s2">/phrf.dta&quot;</span><span class="p">,</span> <span class="n">nogen</span> <span class="n">keep</span><span class="p">(</span><span class="n">master</span> <span class="n">match</span><span class="p">)</span> <span class="n">keepus</span><span class="p">(</span><span class="n">bcphrf</span> <span class="n">bdpbleib</span> <span class="n">bepbleib</span> <span class="n">bfpbleib</span> <span class="n">bgpbleib</span><span class="p">)</span>
<span class="n">gen</span> <span class="n">wlong</span> <span class="o">=</span> <span class="n">bcphrf</span><span class="o">*</span><span class="n">bdpbleib</span><span class="o">*</span><span class="n">bepbleib</span><span class="o">*</span><span class="n">bfpbleib</span><span class="o">*</span><span class="n">bgpbleib</span>
<span class="n">label</span> <span class="n">variable</span> <span class="n">wlong</span> <span class="s2">&quot;Weighting BC-BG&quot;</span>
<span class="n">rename</span> <span class="n">persnr</span> <span class="n">pid</span>
</pre></div>
</td></tr></table></div>
<p>Now estimate the model from 5e) and use the created weight.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">xtreg</span> <span class="n">lwage</span> <span class="n">married</span> <span class="n">c</span><span class="o">.</span><span class="n">pgexpft</span><span class="c1">##c.pgexpft pgbilzeit i.syear [pw=wlong], fe vce(cluster pid)</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/fixed_12.PNG" src="../_images/fixed_12.PNG" />
</div>
<p>The number of observations is now much smaller. The effect of pgbilzeit is stronger than before. Pgbilzeit has a lower effect in the wlong==0 group, where the return is different for each additional educational year.  People in the wlong===0 group may not get the return for the additional education they expected on the local labour market and may therefore move -&gt; higher probability for dropout.</p>
</div>
<div class="section" id="working-with-soep-regional-data">
<h2>Working with SOEP Regional Data<a class="headerlink" href="#working-with-soep-regional-data" title="Permalink to this headline">¶</a></h2>
<p>SOEP offers diverse possibilities for regional and spatial analysis. With the anonymized regional information on the residences of SOEP respondents (households and individuals), it is possible to link numerous regional indicators on the levels of the states (Bundesländer), spatial planning regions, districts, and postal codes with the SOEP data on these households. However, specific security provisions must be observed due to the sensitivity of the data under data protection law. Accordingly, you are not allowed to make statements on, e.g., place of residence or administrative district in your analyses, but the data does provide valuable background information.</p>
<div class="figure align-center">
<img alt="../_images/regionaldata_en.jpg" src="../_images/regionaldata_en.jpg" />
</div>
<p>For more Information and to get access visit <a href="https://www.diw.de/en/diw_02.c.222520.en/regional_data.html" target="_blank">Regional Data</a> </p>
<p>For your research project you want to measure current (year 2016) urban-rural differences in the population. You are particularly interested in the differences in political interest and the different satisfaction variables provided by the SOEP.  You also want to take into account demographic differences in gender and age. In order to be able to evaluate the research potential, you should get an overview. For regional analyses, for example, the community size classes from the regional data are suitable.</p>
<p><strong>Create an exercise path with four subfolders:</strong></p>
<div class="figure align-center">
<img alt="../_images/uebungspfade.PNG" src="../_images/uebungspfade.PNG" />
</div>
<p><strong>Example:</strong></p>
<ul class="simple">
<li>H:/material/exercises/do</li>
<li>H:/material/exercises/output</li>
<li>H:/material/exercises/temp</li>
<li>H:/material/exercises/log</li>
</ul>
<p>These are used to store your script, log files, datasets and temporary datasets. Open an empty do file and define your created paths with globals:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">***********************************************</span>
<span class="o">*</span> <span class="n">Set</span> <span class="n">relative</span> <span class="n">paths</span> <span class="n">to</span> <span class="n">the</span> <span class="n">working</span> <span class="n">directory</span>
<span class="o">***********************************************</span>
<span class="k">global</span> <span class="n">AVZ</span> 	<span class="s2">&quot;H:\material\exercises&quot;</span>
<span class="k">global</span> <span class="n">MY_IN_PATH</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume</span><span class="se">\r</span><span class="s2">dc-prod\complete\soep-core\soep.v33.2\stata_en</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">region</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">hume\soep-region\DATA\soep33_de</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_DO_FILES</span> <span class="s2">&quot;$AVZ\do</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_LOG_OUT</span> <span class="s2">&quot;$AVZ\log</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_DATA</span> <span class="s2">&quot;$AVZ\output</span><span class="se">\&quot;</span>
<span class="k">global</span> <span class="n">MY_OUT_TEMP</span> <span class="s2">&quot;$AVZ</span><span class="se">\t</span><span class="s2">emp</span><span class="se">\&quot;</span>
</pre></div>
</td></tr></table></div>
<p>The global „AVZ“ defines the main path. The main paths are subdivided using the globals “MY_IN_PATH”, “MY_DO_FILES”, “MY_LOG_OUT”, “MY_OUT_DATA”, “MY_OUT_TEMP”. The global “MY_IN_PATH” contains the path to your ordered data.</p>
<p><strong>a) Prepare a cross-sectional analysis data set covering the survey year 2016 (wave bg).</strong></p>
<p>To perform your analysis, you need different SOEP variables. The SOEP offers various options for a variable search:</p>
<ul class="simple">
<li>Search the questionnaires for useful variables. (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#quest-search"><span class="std std-ref">Variable Search with Questionnaires</span></a>)</li>
<li>Find a suitable variable via the topic list of paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#topic"><span class="std std-ref">Topic Search with paneldata.org</span></a>)</li>
<li>Search for a suitable variable using a search term in paneldata.org (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#var-search"><span class="std std-ref">Variable Search with paneldata.org</span></a>)</li>
<li>Use the documentation provided by the generated variables (for more information visit the chapter <a class="reference internal" href="../Working with SOEP Documentation/index.html#documentation"><span class="std std-ref">Documentation of Generated Data</span></a>)</li>
</ul>
<p>Your source file should contain the following variables:</p>
<ul class="simple">
<li>Never Changing Person ID <a href="https://paneldata.org/soep-core/data/ppfad/persnr" target="_blank">"persnr"</a> </li>
<li>Original Household Number <a href="https://paneldata.org/soep-core/data/ppfad/hhnr" target="_blank">"hhnr"</a> </li>
<li>Current Wave Household Number <a href="https://paneldata.org/soep-core/data/ppfad/bghhnr" target="_blank">"bghhnr"</a> </li>
<li>The sex of the person <a href="https://paneldata.org/soep-core/data/ppfad/sex" target="_blank">"sex"</a> </li>
<li>Year of birth <a href="https://paneldata.org/soep-core/data/ppfad/gebjahr" target="_blank">"gebjahr"</a> </li>
<li>Survey Status 2016 <a href="https://paneldata.org/soep-core/data/ppfad/bgnetto" target="_blank">"bgnetto"</a> </li>
<li>Sample Membership 2016 <a href="https://paneldata.org/soep-core/data/ppfad/bgpop" target="_blank">"bgpop"</a> </li>
<li>Weighting Factor 2016 <a href="https://paneldata.org/soep-core/data/phrf/bgphrf  " target="_blank">"bgphrf"</a> </li>
<li>Satisfaction With Health <a href="https://paneldata.org/soep-core/data/bgp/bgp0101  " target="_blank">"bgp0101"</a> </li>
<li>Satisfaction With Sleep <a href="https://paneldata.org/soep-core/data/bgp/bgp0102  " target="_blank">"bgp0102"</a> </li>
<li>Satisfaction With Work <a href="https://paneldata.org/soep-core/data/bgp/bgp0103  " target="_blank">"bgp0103"</a> </li>
<li>Satisfaction With Housework <a href="https://paneldata.org/soep-core/data/bgp/bgp0104  " target="_blank">"bgp0104"</a> </li>
<li>Satisfaction With Household Income <a href="https://paneldata.org/soep-core/data/bgp/bgp0105  " target="_blank">"bgp0105"</a> </li>
<li>Satisfaction With Personal Income <a href="https://paneldata.org/soep-core/data/bgp/bgp0106  " target="_blank">"bgp0106"</a> </li>
<li>Satisfaction With Dwelling <a href="https://paneldata.org/soep-core/data/bgp/bgp0107  " target="_blank">"bgp0107"</a> </li>
<li>Satisfaction With Amount Of Leisure Time <a href="https://paneldata.org/soep-core/data/bgp/bgp0108  " target="_blank">"bgp0108"</a> </li>
<li>Satisfaction With Child Care <a href="https://paneldata.org/soep-core/data/bgp/bgp0109  " target="_blank">"bgp0109"</a> </li>
<li>Satisfaction With Family Life <a href="https://paneldata.org/soep-core/data/bgp/bgp0110  " target="_blank">"bgp0110"</a> </li>
<li>Satisfaction With Social Life <a href="https://paneldata.org/soep-core/data/bgp/bgp0111  " target="_blank">"bgp0111"</a> </li>
<li>Zufriedenheit mit Demokratie <a href="https://paneldata.org/soep-core/data/bgp/bgp0112  " target="_blank">"bgp0112"</a> </li>
<li>Political Interests <a href="https://paneldata.org/soep-core/data/bgp/bgp143  " target="_blank">"bgp143"</a> </li>
<li>Current Sample Region <a href="https://paneldata.org/soep-core/data/bghbrutto/bgsampreg " target="_blank">"bgsampreg"</a> </li>
<li>Federal State <a href="https://paneldata.org/soep-core/data/bghbrutto/bgbula " target="_blank">"bgbula"</a> </li>
<li>Spatial category by BBSR <a href="https://paneldata.org/soep-core/data/bghbrutto/bgregtyp " target="_blank">"bgregtyp"</a> </li>
<li>Community Class Sizes “ggk”</li>
</ul>
<p>Use the various important variables of the ppfad.dta data set as your start file.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>use hhnr persnr bghhnr sex gebjahr bgnetto bgpop using ${MY_IN_PATH}\ppfad.dta, clear
</pre></div>
</td></tr></table></div>
<p>Keep people who completed a questionnaire in 2016 and live in a private household.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* Keep people who completed a questionnaire in 2016 and live in a private household
keep if bghhnr&gt;0 &amp; inrange(bgnetto, 10, 29) &amp; inlist(bgpop, 1, 2)
keep hhnr persnr bghhnr sex gebjahr bgnetto bgpop
merge 1:1  persnr using ${MY_IN_PATH}\phrf.dta, keep(match master) keepusing (bgphrf) nogenerate
tempfile ppfad
save `ppfad&#39;
</pre></div>
</td></tr></table></div>
<p>Prepare the different data sets bgp, bghbrutto, regiobl</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* Prepare data set bgp
use ${MY_IN_PATH}\bgp.dta, replace
keep persnr hhnr bghhnr bgp01* bgp143
tempfile bgp
save `bgp&#39;

* Prepare data set bghbrutto
use ${MY_IN_PATH}\bghbrutto.dta, replace
keep hhnr bghhnr bgsampreg bgbula bgregtyp
tempfile bghbrutto
save `bghbrutto&#39;

* Prepare data set regionl
use ${region}\regionl_v33.dta, replace
keep if syear==2016
keep syear hhnr hhnrakt ggk
rename hhnrakt bghhnr
tempfile regionl
save `regionl&#39;
</pre></div>
</td></tr></table></div>
<p>Merge all data sets.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* Merge all data sets
use `ppfad&#39;
merge 1:1 persnr using `bgp&#39;, keep(match master) nogenerate
merge m:1 bghhnr hhnr using `regionl&#39;, keep(match master) nogenerate
merge m:1 bghhnr hhnr using `bghbrutto&#39;, keep(match master) nogenerate
</pre></div>
</td></tr></table></div>
<p>Recode negative values into missings.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Recode</span> <span class="n">negative</span> <span class="n">values</span> <span class="n">into</span> <span class="n">missings</span>
<span class="n">mvdecode</span> <span class="n">sex</span> <span class="n">gebjahr</span> <span class="n">bgp01</span><span class="o">*</span> <span class="n">bgp143</span><span class="p">,</span><span class="n">mv</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Categorize the community class sizes of the SOEP regional data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Categorize</span> <span class="n">community</span> <span class="k">class</span> <span class="nc">size</span>
<span class="n">gen</span> <span class="n">ggk_cat</span><span class="o">=.</span>
<span class="n">replace</span> <span class="n">ggk_cat</span><span class="o">=-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ggk</span><span class="o">==-</span><span class="mi">1</span>
<span class="n">replace</span> <span class="n">ggk_cat</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">ggk</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="n">ggk</span><span class="o">==</span><span class="mi">2</span>
<span class="n">replace</span> <span class="n">ggk_cat</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">ggk</span><span class="o">==</span><span class="mi">3</span>
<span class="n">replace</span> <span class="n">ggk_cat</span><span class="o">=</span><span class="mi">3</span> <span class="k">if</span> <span class="n">ggk</span><span class="o">==</span><span class="mi">4</span> <span class="o">|</span> <span class="n">ggk</span><span class="o">==</span><span class="mi">5</span>
<span class="n">replace</span> <span class="n">ggk_cat</span><span class="o">=</span><span class="mi">4</span> <span class="k">if</span> <span class="n">ggk</span><span class="o">&gt;</span><span class="mi">5</span> <span class="o">&amp;</span> <span class="n">ggk</span><span class="o">&lt;=</span><span class="mi">7</span>

<span class="n">lab</span> <span class="n">var</span> <span class="n">ggk_cat</span> <span class="s2">&quot;Community Size categorised&quot;</span>
<span class="n">lab</span> <span class="k">def</span> <span class="nf">ggk_cat</span> <span class="o">-</span><span class="mi">1</span> <span class="s2">&quot;No information&quot;</span> <span class="mi">1</span> <span class="s2">&quot;&lt;=5000&quot;</span> <span class="mi">2</span> <span class="s2">&quot;5001 - 20000&quot;</span> <span class="mi">3</span> <span class="s2">&quot;20001 - 100000&quot;</span> <span class="o">///</span> 
<span class="mi">4</span> <span class="s2">&quot;&gt;100000&quot;</span>
<span class="n">lab</span> <span class="n">val</span> <span class="n">ggk_cat</span> <span class="n">ggk_cat</span>
</pre></div>
</td></tr></table></div>
<p>Generate an age variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Generate</span> <span class="n">age</span> <span class="n">variable</span>
<span class="n">gen</span> <span class="n">alter</span><span class="o">=</span> <span class="mi">2016</span><span class="o">-</span><span class="n">gebjahr</span> <span class="k">if</span> <span class="n">gebjahr</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="n">gen</span> <span class="n">alter_cat</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">alter</span><span class="o">&lt;=</span><span class="mi">20</span>
<span class="n">replace</span> <span class="n">alter_cat</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">alter</span><span class="o">&gt;</span><span class="mi">20</span> <span class="o">&amp;</span> <span class="n">alter</span><span class="o">&lt;=</span><span class="mi">30</span>
<span class="n">replace</span> <span class="n">alter_cat</span><span class="o">=</span><span class="mi">3</span> <span class="k">if</span> <span class="n">alter</span><span class="o">&gt;</span><span class="mi">30</span> <span class="o">&amp;</span> <span class="n">alter</span><span class="o">&lt;=</span><span class="mi">65</span>
<span class="n">replace</span> <span class="n">alter_cat</span><span class="o">=</span><span class="mi">4</span> <span class="k">if</span> <span class="n">alter</span><span class="o">&gt;</span><span class="mi">65</span> <span class="o">&amp;</span> <span class="n">alter</span><span class="o">&lt;=</span><span class="mi">120</span>

<span class="n">lab</span> <span class="n">var</span> <span class="n">alter</span> <span class="s2">&quot;age&quot;</span>
<span class="n">lab</span> <span class="n">var</span> <span class="n">alter_cat</span> <span class="s2">&quot;age categorized&quot;</span>
<span class="n">lab</span> <span class="k">def</span> <span class="nf">alter_cat</span> <span class="mi">1</span> <span class="s2">&quot;&lt;=20&quot;</span> <span class="mi">2</span> <span class="s2">&quot;21-30&quot;</span> <span class="mi">3</span> <span class="s2">&quot;31-65&quot;</span> <span class="mi">4</span> <span class="s2">&quot;&gt;65&quot;</span>
<span class="n">lab</span> <span class="n">val</span> <span class="n">alter_cat</span> <span class="n">alter_cat</span> 
</pre></div>
</td></tr></table></div>
<p>Categorize federal states variable.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">*</span> <span class="n">Categorize</span> <span class="n">federal</span> <span class="n">states</span>
<span class="n">gen</span> <span class="n">bgbula_cat</span><span class="o">=.</span>
<span class="o">*</span> <span class="n">Schleswig</span><span class="o">-</span><span class="n">Holstein</span> <span class="o">+</span> <span class="n">Hamburg</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">1</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">1</span> <span class="o">|</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">2</span>
<span class="o">*</span> <span class="n">Lower</span> <span class="n">Saxony</span> <span class="o">+</span> <span class="n">Bremen</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">2</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">3</span> <span class="o">|</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">4</span>
<span class="o">*</span> <span class="n">Mecklenburg</span> <span class="n">Western</span> <span class="n">Pomerania</span> <span class="o">+</span> <span class="n">Brandenburg</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">3</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">13</span> <span class="o">|</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">12</span>
<span class="o">*</span> <span class="n">Saarland</span> <span class="o">+</span> <span class="n">Rhineland</span> <span class="n">Palatinate</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">4</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">7</span> <span class="o">|</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">10</span>
<span class="o">*</span> <span class="n">Northrhine</span><span class="o">-</span><span class="n">Westphalia</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">5</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">5</span>
<span class="o">*</span> <span class="n">Hesse</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">6</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">6</span>
<span class="o">*</span> <span class="n">Baden</span><span class="o">-</span><span class="n">Württemberg</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">7</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">8</span>
<span class="o">*</span> <span class="n">Bavaria</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">8</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">9</span>
<span class="o">*</span> <span class="n">Berlin</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">9</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">11</span>
<span class="o">*</span> <span class="n">Saxony</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">10</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">14</span>
<span class="o">*</span> <span class="n">Saxony</span><span class="o">-</span><span class="n">Anhalt</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">11</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">15</span>
<span class="o">*</span> <span class="n">Thuringia</span>
<span class="n">replace</span> <span class="n">bgbula_cat</span><span class="o">=</span><span class="mi">12</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">16</span>

<span class="n">lab</span> <span class="n">var</span> <span class="n">bgbula_cat</span> <span class="s2">&quot;Federal states categorized&quot;</span>
<span class="n">lab</span> <span class="k">def</span> <span class="nf">bgbula_cat</span> <span class="mi">1</span> <span class="s2">&quot;Schleswig-Holstein/Hamburg&quot;</span> <span class="mi">2</span> <span class="s2">&quot;Lower Saxony/Bremen&quot;</span> <span class="mi">3</span> <span class="s2">&quot;Mecklenburg Western Pomerania/Brandenburg&quot;</span> <span class="o">///</span> 
<span class="mi">4</span> <span class="s2">&quot;Saarland/Rhineland Palatinate&quot;</span> <span class="mi">5</span> <span class="s2">&quot;Northrhine-Westphalia&quot;</span> <span class="mi">6</span> <span class="s2">&quot;Hesse&quot;</span> <span class="o">///</span> 
<span class="mi">7</span> <span class="s2">&quot;Baden-Wuerttenberg&quot;</span> <span class="mi">8</span> <span class="s2">&quot;Bavaria&quot;</span> <span class="mi">9</span> <span class="s2">&quot;Berlin&quot;</span> <span class="mi">10</span> <span class="s2">&quot;Saxony&quot;</span> <span class="mi">11</span> <span class="s2">&quot;Saxony-Anhalt&quot;</span> <span class="mi">12</span> <span class="s2">&quot;Thuringia&quot;</span>
<span class="n">lab</span> <span class="n">val</span> <span class="n">bgbula_cat</span> <span class="n">bgbula_cat</span>
<span class="n">drop</span> <span class="n">bgbula</span>
<span class="n">rename</span> <span class="n">bgbula_cat</span> <span class="n">bgbula</span>
</pre></div>
</td></tr></table></div>
<p>Put the variables in your preferred order and save your data set.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span>* Order demography and identifiers first
order persnr hhnr bghhnr syear sex gebjahr alter alter_cat bgsampreg bgbula ggk /// 
ggk_cat bgregtyp  

save ${MY_OUT_DATA}\zeit_online.dta, replace
</pre></div>
</td></tr></table></div>
<p><strong>b) You want to get an initial overview of regional differences in satisfaction with various aspects in Germany. Use the variable bgsampreg and cross-stabilize the variable with all satisfaction variables to identify differences between East and West Germany, display the absolute and relative frequencies.</strong></p>
<p>To save the tables, save them in a log file.</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span>********************************************************************************
capture log close
log using &quot;${MY_LOG_OUT}\satisfaction.log&quot;, replace

* Life satisfaction

local varlist bgp0101 bgp0102 bgp0103 bgp0104 bgp0105 bgp0106 bgp0107 bgp0108 /// 
bgp0109 bgp0110 bgp0111 bgp0112
foreach x of local varlist {
tab bgsampreg `x&#39; [aw= bgphrf] , row
}
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/reg_01.PNG" src="../_images/reg_01.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/reg_02.PNG" src="../_images/reg_02.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/reg_03.PNG" src="../_images/reg_03.PNG" />
</div>
<p>To view all tables, look at your generated log file.</p>
<p><strong>c) Now take a closer look at satisfaction with various aspects of life with the help of SOEP regional data. Use the community size classes. Create a table showing you satisfaction with different aspects of life and revealing differences by gender, age, community size class and federal state.</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span>foreach x of local varlist {
* Tabulation of satisfaction by size of community and federal state
table `x&#39; sex alter_cat, by(bgbula ggk_cat) contents(freq) column row stubwidth(20) cellwidth(8) csepwidth(2) nomissing
* Tabulation of satisfaction by size of community
table `x&#39; sex alter_cat, by(ggk_cat) contents(freq) column row stubwidth(20) cellwidth(8) csepwidth(2) nomissing
* Tabulation of satisfaction by federal state
table `x&#39; sex alter_cat, by(bgbula) contents(freq) column row stubwidth(20) cellwidth (8) csepwidth(2) nomissing 
}
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/reg_08.PNG" src="../_images/reg_08.PNG" />
</div>
<div class="figure align-center">
<img alt="../_images/reg_10.PNG" src="../_images/reg_10.PNG" />
</div>
<p>To view all tables, look at your generated log file. As you can see, SOEP regional data can be used to analyze variables at the smallest regional levels.</p>
<p><strong>d) Create a table that shows you the political interest differentiated by age, gender and community size class for Bavaria</strong></p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="o">********************************************************************************</span>
<span class="n">capture</span> <span class="n">log</span> <span class="n">close</span>
<span class="n">log</span> <span class="n">using</span> <span class="s2">&quot;$</span><span class="si">{MY_LOG_OUT}</span><span class="s2">\political_interest.log&quot;</span><span class="p">,</span> <span class="n">replace</span>

<span class="o">*</span> <span class="n">Political</span> <span class="n">interest</span>
<span class="o">*</span> <span class="n">Tabulation</span> <span class="n">of</span> <span class="n">political</span> <span class="n">interest</span> <span class="n">by</span> <span class="n">size</span> <span class="n">of</span> <span class="n">community</span> <span class="k">for</span> <span class="n">Bavaria</span>
<span class="n">table</span> <span class="n">bgp143</span> <span class="n">sex</span> <span class="n">alter_cat</span> <span class="k">if</span> <span class="n">bgbula</span><span class="o">==</span><span class="mi">8</span><span class="p">,</span> <span class="n">by</span><span class="p">(</span><span class="n">ggk_cat</span><span class="p">)</span> <span class="n">contents</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span> <span class="n">column</span> <span class="n">row</span> <span class="n">stubwidth</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="n">cellwidth</span> <span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="n">csepwidth</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">nomissing</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center">
<img alt="../_images/reg_11.PNG" src="../_images/reg_11.PNG" />
</div>
<p>It becomes clear that the SOEP offers a wide range of possibilities for region-related analyses. It is possible to allocate a multitude of regional indicators at the level of the federal states, the regional planning regions, the districts and the postal codes.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Working with SOEP Documentation/index.html" class="btn btn-neutral float-right" title="Working with SOEP Documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../Principles of Data Structure/index.html" class="btn btn-neutral" title="Principles of Data Structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, SOEP.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>